/*!
 * Â© Peculiar Ventures https://peculiarventures.com/ - MIT License
 */
import{A as t,t as s,u as e,v as i,w as r,E as a,g as n,x as o,U as h,y as c,z as u,B as l,V as E,D as m,I as f,F as g,W as A,G as p,H as b,J as d,T as w,K as x,L as C,M as T,O as R,P as I,Q as v,S as k,X as N,e as F,Y as y,f as B,s as D,q as P,r as H,Z as S,N as L,h as X,j as U,k as j,R as q,_ as G}from"./p-74c241e7.js";import{b as K,D as M}from"./p-a053c132.js";
/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */class $ extends t{getAsnExtnValue(){return this.asn.values[0]}constructor(t){super(t,s);const F=this.getAsnExtnValue();switch(this.asn.type){case k:this.value=i.parse(F,N);break;case I:this.value=i.parse(F,v);break;case T:this.value=i.parse(F,R);break;case x:this.value=i.parse(F,C);break;case d:this.value=i.parse(F,w);break;case p:this.value=i.parse(F,b);break;case g:this.value=i.parse(F,A);break;case m:this.value=i.parse(F,f);break;case l:this.value=i.parse(F,E);break;case c:this.value=i.parse(F,u);break;case o:this.value=i.parse(F,h);break;case e:{const t=i.parse(F,r);this.value=t.map((t=>new a(n.serialize(t))));break}default:this.value=K.Convert.ToHex(F)}}}
/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */class O extends t{constructor(t){var s;super(F(t),y);this.thumbprints={};this.type="X.509 Attribute Certificate";const{acinfo:e}=this.asn;this.serialNumber=K.Convert.ToHex(e.serialNumber);this.version=e.version;const i=e.attrCertValidityPeriod.notBeforeTime;if(!i){throw new Error("Cannot get 'notBefore' value")}this.notBefore=i;const r=e.attrCertValidityPeriod.notAfterTime;if(!r){throw new Error("Cannot get 'notAfter' value")}this.notAfter=r;this.validity=B(this.notBefore,this.notAfter);this.issuer=e.issuer.v1Form||((s=e.issuer.v2Form)===null||s===void 0?void 0:s.issuerName);this.holder=e.holder}get signature(){const{signatureValue:t,signatureAlgorithm:s}=this.asn;return{value:t,algorithm:s.algorithm}}parseExtensions(){const{acinfo:t}=this.asn;if(t.extensions){this.extensions=t.extensions.map((t=>new a(n.serialize(t))))}}parseAttributes(){const{acinfo:t}=this.asn;if(t.attributes){this.attributes=t.attributes.map((t=>new $(n.serialize(t))))}}async getThumbprint(t="SHA-1"){try{const s=await D(t,this.raw);if(s){this.thumbprints[t]=K.Convert.ToHex(s)}}catch(t){console.error("Error thumbprint get:",t)}}exportAsBase64(){return K.Convert.ToBase64(this.raw)}exportAsHexFormatted(){return P(K.Convert.ToHex(this.raw))}exportAsPemFormatted(){return`-----BEGIN ATTRIBUTE CERTIFICATE-----\n${H(this.exportAsBase64())}\n-----END ATTRIBUTE CERTIFICATE-----`}get commonName(){return`attribute-certificate-${this.thumbprints["SHA-1"]}`}downloadAsPEM(t){M.attrCert.asPEM(this.exportAsPemFormatted(),t||this.commonName)}downloadAsDER(t){M.attrCert.asDER(this.exportAsHexFormatted(),t||this.commonName)}}
/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */class Q extends t{constructor(t){super(F(t),S);this.thumbprints={};this.type="PKCS#10 Certificate Request";const{certificationRequestInfo:s}=this.asn;this.subject=new L(s.subject).toJSON();this.version=s.version}get publicKey(){const{subjectPublicKey:t,algorithm:s}=this.asn.certificationRequestInfo.subjectPKInfo;let e;if(s.algorithm===X&&s.parameters){e=n.parse(s.parameters,U)}if(s.algorithm===j){e=n.parse(t,q)}const i=n.serialize(this.asn.certificationRequestInfo.subjectPKInfo);return{params:e,value:i,algorithm:s.algorithm}}get signature(){const{signature:t,signatureAlgorithm:s}=this.asn;return{value:t,algorithm:s.algorithm}}get commonName(){if(!this.subject){return""}for(let t=0;t<this.subject.length;t+=1){const s=this.subject[t];if(s.shortName==="CN"||s.shortName==="E"||s.shortName==="O"){return s.value}}return""}async getThumbprint(t="SHA-1"){try{const s=await D(t,this.raw);if(s){this.thumbprints[t]=K.Convert.ToHex(s)}}catch(t){console.error("Error thumbprint get:",t)}}parseAttributes(){const{certificationRequestInfo:t}=this.asn;if(t.attributes){this.attributes=t.attributes.map((t=>new $(n.serialize(t))))}}exportAsBase64(){return K.Convert.ToBase64(this.raw)}exportAsHexFormatted(){return P(K.Convert.ToHex(this.raw))}exportAsPemFormatted(){return`-----BEGIN CERTIFICATE REQUEST-----\n${H(this.exportAsBase64())}\n-----END CERTIFICATE REQUEST-----`}downloadAsPEM(t){M.csr.asPEM(this.exportAsPemFormatted(),t||this.commonName)}downloadAsDER(t){M.csr.asDER(this.exportAsHexFormatted(),t||this.commonName)}}
/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */class V extends t{constructor(t){super(F(t),G);this.thumbprints={};this.type="X.509 Certificate Revocation List";const{tbsCertList:s}=this.asn;this.issuer=new L(s.issuer).toJSON();this.version=s.version+1;this.lastUpdate=s.thisUpdate.getTime();this.nextUpdate=s.nextUpdate.getTime();this.revokedCertificates=(s.revokedCertificates||[]).map((t=>{var s;return{revocationDate:t.revocationDate,userCertificate:t.userCertificate,crlEntryExtensions:(s=t.crlEntryExtensions)===null||s===void 0?void 0:s.map((t=>new a(n.serialize(t))))}}))}async getThumbprint(t="SHA-1"){try{const s=await D(t,this.raw);if(s){this.thumbprints[t]=K.Convert.ToHex(s)}}catch(t){console.error("Error thumbprint get:",t)}}get signature(){const{signature:t,signatureAlgorithm:s}=this.asn;return{value:t,algorithm:s.algorithm}}get commonName(){if(!this.issuer){return""}for(let t=0;t<this.issuer.length;t+=1){const s=this.issuer[t];if(s.shortName==="CN"||s.shortName==="E"||s.shortName==="O"){return s.value}}return""}parseExtensions(){const{tbsCertList:t}=this.asn;if(t.crlExtensions){this.extensions=t.crlExtensions.map((t=>new a(n.serialize(t))))}}exportAsBase64(){return K.Convert.ToBase64(this.raw)}exportAsHexFormatted(){return P(K.Convert.ToHex(this.raw))}exportAsPemFormatted(){return`-----BEGIN X509 CRL-----\n${H(this.exportAsBase64())}\n-----END X509 CRL-----`}downloadAsPEM(t){M.crl.asPEM(this.exportAsPemFormatted(),t||this.commonName)}downloadAsDER(t){M.crl.asDER(this.exportAsHexFormatted(),t||this.commonName)}}export{Q as C,O as X,V as a};
//# sourceMappingURL=p-43eb3721.js.map