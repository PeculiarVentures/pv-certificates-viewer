{"version":3,"file":"p-CZuaTO2G.js","sources":["../../node_modules/.pnpm/@peculiar+asn1-cert-transparency@2.4.0/node_modules/@peculiar/asn1-cert-transparency/build/es2015/cert_transparency.js","../../node_modules/.pnpm/@peculiar+asn1-x509-logotype@2.4.0/node_modules/@peculiar/asn1-x509-logotype/build/es2015/object_identifiers.js","src/crypto/extension.ts"],"sourcesContent":["import { OctetString } from \"@peculiar/asn1-schema\";\nimport { SignedCertificateTimestamp } from \"./timestamp\";\nimport { ByteStream } from \"./byte_stream\";\nexport const id_certificateTransparency = \"1.3.6.1.4.1.11129.2.4.2\";\nexport class CertificateTransparency extends OctetString {\n    constructor() {\n        super(...arguments);\n        this.items = [];\n    }\n    fromASN(asn) {\n        super.fromASN(asn);\n        const stream = new ByteStream(this.buffer);\n        const len = stream.readNumber(2);\n        this.items = [];\n        while (stream.position < len) {\n            this.items.push(new SignedCertificateTimestamp(stream));\n        }\n        return this;\n    }\n    toJSON() {\n        return this.items.map((o) => o.toJSON());\n    }\n}\n","import { id_pkix } from \"@peculiar/asn1-x509\";\nexport const id_pe_logotype = \"1.3.6.1.5.5.7.1.12\";\nexport const id_logo = `${id_pkix}.20`;\nexport const id_logo_loyalty = `${id_logo}.1`;\nexport const id_logo_background = `${id_logo}.2`;\nexport const id_logo_certImage = `${id_logo}.3`;\n","/**\n * @license\n * Copyright (c) Peculiar Ventures, LLC.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { Convert } from 'pvtsutils';\nimport {\n  Extension as AsnExtension,\n\n  id_pe_authorityInfoAccess,\n  AuthorityInfoAccessSyntax,\n\n  id_ce_authorityKeyIdentifier,\n  AuthorityKeyIdentifier,\n\n  id_ce_basicConstraints,\n  BasicConstraints,\n\n  id_ce_certificateIssuer,\n  CertificateIssuer,\n\n  id_ce_certificatePolicies,\n  CertificatePolicies,\n\n  id_ce_cRLDistributionPoints,\n  CRLDistributionPoints,\n\n  id_ce_issuingDistributionPoint,\n  IssuingDistributionPoint,\n\n  id_ce_cRLReasons,\n  CRLReason,\n\n  id_ce_extKeyUsage,\n  ExtendedKeyUsage,\n\n  id_ce_inhibitAnyPolicy,\n  InhibitAnyPolicy,\n\n  id_ce_invalidityDate,\n  InvalidityDate,\n\n  id_ce_issuerAltName,\n  IssueAlternativeName,\n\n  id_ce_keyUsage,\n  KeyUsage,\n\n  id_ce_nameConstraints,\n  NameConstraints,\n\n  id_ce_policyConstraints,\n  PolicyConstraints,\n\n  id_ce_policyMappings,\n  PolicyMappings,\n\n  id_ce_subjectAltName,\n  SubjectAlternativeName,\n\n  id_ce_subjectDirectoryAttributes,\n  SubjectDirectoryAttributes,\n\n  id_ce_subjectKeyIdentifier,\n  SubjectKeyIdentifier,\n\n  id_ce_privateKeyUsagePeriod,\n  PrivateKeyUsagePeriod,\n\n  id_entrust_entrustVersInfo,\n  EntrustVersionInfo,\n\n  id_pe_subjectInfoAccess,\n  SubjectInfoAccessSyntax,\n\n  id_ce_cRLNumber,\n  CRLNumber,\n\n  id_ce_deltaCRLIndicator,\n  BaseCRLNumber,\n} from '@peculiar/asn1-x509';\nimport {\n  id_pe_qcStatements,\n  QCStatements,\n\n  id_pe_biometricInfo,\n  BiometricSyntax,\n} from '@peculiar/asn1-x509-qualified';\nimport {\n  id_certificateTemplate,\n  CertificateTemplate,\n\n  id_enrollCertType,\n  EnrollCertTypeChoice,\n\n  id_caVersion,\n  CaVersion,\n} from '@peculiar/asn1-x509-microsoft';\nimport {\n  id_netscapeComment,\n  NetscapeComment,\n\n  id_netscapeCertType,\n  NetscapeCertType,\n} from '@peculiar/asn1-x509-netscape';\nimport { AsnParser } from '@peculiar/asn1-schema';\nimport {\n  id_lei,\n  LeiChoice,\n\n  id_role,\n  LeiRole,\n} from '@peculiar/asn1-lei';\nimport {\n  id_certificateTransparency,\n  CertificateTransparency,\n} from '@peculiar/asn1-cert-transparency';\nimport {\n  id_adbe_timestamp,\n  Timestamp,\n\n  id_adbe_archiveRevInfo,\n  ArchiveRevInfo,\n} from '@peculiar/asn1-adobe-acrobat';\nimport {\n  id_pe_logotype,\n  LogotypeExtn,\n} from '@peculiar/asn1-x509-logotype';\nimport {\n  id_pe_TNAuthList,\n  TNAuthorizationList,\n} from '@peculiar/asn1-rfc8226';\nimport {\n  id_ce_keyDescription,\n  NonStandardKeyDescription,\n} from '@peculiar/asn1-android';\nimport {\n  id_cabforganizationIdentifier,\n  CabforganizationIdentifier,\n} from './extensions';\nimport { AsnData } from './asn_data';\n\nconst extensionParsers = {\n  [id_pe_authorityInfoAccess]: AuthorityInfoAccessSyntax,\n  [id_ce_authorityKeyIdentifier]: AuthorityKeyIdentifier,\n  [id_ce_basicConstraints]: BasicConstraints,\n  [id_ce_certificateIssuer]: CertificateIssuer,\n  [id_ce_certificatePolicies]: CertificatePolicies,\n  [id_ce_cRLDistributionPoints]: CRLDistributionPoints,\n  '2.5.29.46': CRLDistributionPoints,\n  [id_ce_issuingDistributionPoint]: IssuingDistributionPoint,\n  [id_ce_cRLReasons]: CRLReason,\n  [id_ce_extKeyUsage]: ExtendedKeyUsage,\n  [id_ce_inhibitAnyPolicy]: InhibitAnyPolicy,\n  [id_ce_invalidityDate]: InvalidityDate,\n  [id_ce_issuerAltName]: IssueAlternativeName,\n  [id_ce_keyUsage]: KeyUsage,\n  [id_ce_nameConstraints]: NameConstraints,\n  [id_ce_policyConstraints]: PolicyConstraints,\n  [id_ce_policyMappings]: PolicyMappings,\n  [id_ce_subjectAltName]: SubjectAlternativeName,\n  [id_ce_subjectDirectoryAttributes]: SubjectDirectoryAttributes,\n  [id_ce_subjectKeyIdentifier]: SubjectKeyIdentifier,\n  [id_pe_qcStatements]: QCStatements,\n  [id_certificateTemplate]: CertificateTemplate,\n  [id_enrollCertType]: EnrollCertTypeChoice,\n  [id_netscapeComment]: NetscapeComment,\n  [id_netscapeCertType]: NetscapeCertType,\n  [id_caVersion]: CaVersion,\n  [id_certificateTransparency]: CertificateTransparency,\n  [id_lei]: LeiChoice,\n  [id_role]: LeiRole,\n  [id_adbe_timestamp]: Timestamp,\n  [id_adbe_archiveRevInfo]: ArchiveRevInfo,\n  [id_ce_privateKeyUsagePeriod]: PrivateKeyUsagePeriod,\n  [id_entrust_entrustVersInfo]: EntrustVersionInfo,\n  '2.16.724.1.2.2.4.1': BiometricSyntax,\n  [id_pe_biometricInfo]: BiometricSyntax,\n  [id_pe_logotype]: LogotypeExtn,\n  [id_pe_TNAuthList]: TNAuthorizationList,\n  [id_pe_subjectInfoAccess]: SubjectInfoAccessSyntax,\n  [id_ce_cRLNumber]: CRLNumber,\n  [id_ce_deltaCRLIndicator]: BaseCRLNumber,\n  [id_ce_keyDescription]: NonStandardKeyDescription,\n  [id_cabforganizationIdentifier]: CabforganizationIdentifier,\n};\n\ntype TExtensionKeys = keyof typeof extensionParsers;\n\nexport type TExtensionValue = InstanceType<typeof extensionParsers[TExtensionKeys]> | string;\n\nexport class Extension<T extends TExtensionValue> extends AsnData<AsnExtension> {\n  public readonly value: T;\n\n  private getAsnExtnValue() {\n    return this.asn.extnValue.buffer;\n  }\n\n  constructor(raw: BufferSource) {\n    super(raw, AsnExtension);\n\n    const asnExtnValue = this.getAsnExtnValue();\n\n    try {\n      const target = extensionParsers[this.asn.extnID];\n\n      if (target) {\n        this.value = AsnParser.parse<T>(asnExtnValue, target);\n      } else {\n        console.warn(`Didn't detect parser for \"${this.asn.extnID}\" extension.`);\n\n        this.value = Convert.ToHex(asnExtnValue) as T;\n      }\n    } catch (error) {\n      console.error(`Error parse \"${this.asn.extnID}\" extension:`, error.message);\n\n      this.value = Convert.ToHex(asnExtnValue) as T;\n    }\n  }\n}\n"],"names":["AsnExtension","Convert"],"mappings":"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","x_google_ignoreList":[0,1]}