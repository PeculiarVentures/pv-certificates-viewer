/*!
 * Â© Peculiar Ventures https://peculiarventures.com/ - MIT License
 */
/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
function t(t,e,s,r="application/octet-stream"){const i=new Blob([t],{type:r});if(navigator.msSaveBlob){navigator.msSaveBlob(i,`${e}.${s}`);return new Promise((t=>{setTimeout(t,100)}))}const n=window.URL.createObjectURL(i);const o=document.createElement("a");const c=document.createElement("iframe");o.style.display="none";c.style.display="none";c.name=n;document.body.appendChild(c);o.href=n;o.target=n;o.download=`${e}.${s}`;document.body.appendChild(o);o.dispatchEvent(new MouseEvent("click"));document.body.removeChild(o);return new Promise((t=>{setTimeout((()=>{document.body.removeChild(c);t()}),100)}))}
/*!
 * MIT License
 * 
 * Copyright (c) 2017-2022 Peculiar Ventures, LLC
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const e="[object ArrayBuffer]";class s{static isArrayBuffer(t){return Object.prototype.toString.call(t)===e}static toArrayBuffer(t){if(this.isArrayBuffer(t)){return t}if(t.byteLength===t.buffer.byteLength){return t.buffer}if(t.byteOffset===0&&t.byteLength===t.buffer.byteLength){return t.buffer}return this.toUint8Array(t.buffer).slice(t.byteOffset,t.byteOffset+t.byteLength).buffer}static toUint8Array(t){return this.toView(t,Uint8Array)}static toView(t,e){if(t.constructor===e){return t}if(this.isArrayBuffer(t)){return new e(t)}if(this.isArrayBufferView(t)){return new e(t.buffer,t.byteOffset,t.byteLength)}throw new TypeError("The provided value is not of type '(ArrayBuffer or ArrayBufferView)'")}static isBufferSource(t){return this.isArrayBufferView(t)||this.isArrayBuffer(t)}static isArrayBufferView(t){return ArrayBuffer.isView(t)||t&&this.isArrayBuffer(t.buffer)}static isEqual(t,e){const r=s.toUint8Array(t);const i=s.toUint8Array(e);if(r.length!==i.byteLength){return false}for(let t=0;t<r.length;t++){if(r[t]!==i[t]){return false}}return true}static concat(...t){let e;if(Array.isArray(t[0])&&!(t[1]instanceof Function)){e=t[0]}else if(Array.isArray(t[0])&&t[1]instanceof Function){e=t[0]}else{if(t[t.length-1]instanceof Function){e=t.slice(0,t.length-1)}else{e=t}}let s=0;for(const t of e){s+=t.byteLength}const r=new Uint8Array(s);let i=0;for(const t of e){const e=this.toUint8Array(t);r.set(e,i);i+=e.length}if(t[t.length-1]instanceof Function){return this.toView(r,t[t.length-1])}return r.buffer}}const r="string";const i=/^[0-9a-f]+$/i;const n=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/;const o=/^[a-zA-Z0-9-_]+$/;class c{static fromString(t){const e=unescape(encodeURIComponent(t));const s=new Uint8Array(e.length);for(let t=0;t<e.length;t++){s[t]=e.charCodeAt(t)}return s.buffer}static toString(t){const e=s.toUint8Array(t);let r="";for(let t=0;t<e.length;t++){r+=String.fromCharCode(e[t])}const i=decodeURIComponent(escape(r));return i}}class a{static toString(t,e=false){const r=s.toArrayBuffer(t);const i=new DataView(r);let n="";for(let t=0;t<r.byteLength;t+=2){const s=i.getUint16(t,e);n+=String.fromCharCode(s)}return n}static fromString(t,e=false){const s=new ArrayBuffer(t.length*2);const r=new DataView(s);for(let s=0;s<t.length;s++){r.setUint16(s*2,t.charCodeAt(s),e)}return s}}class u{static isHex(t){return typeof t===r&&i.test(t)}static isBase64(t){return typeof t===r&&n.test(t)}static isBase64Url(t){return typeof t===r&&o.test(t)}static ToString(t,e="utf8"){const r=s.toUint8Array(t);switch(e.toLowerCase()){case"utf8":return this.ToUtf8String(r);case"binary":return this.ToBinary(r);case"hex":return this.ToHex(r);case"base64":return this.ToBase64(r);case"base64url":return this.ToBase64Url(r);case"utf16le":return a.toString(r,true);case"utf16":case"utf16be":return a.toString(r);default:throw new Error(`Unknown type of encoding '${e}'`)}}static FromString(t,e="utf8"){if(!t){return new ArrayBuffer(0)}switch(e.toLowerCase()){case"utf8":return this.FromUtf8String(t);case"binary":return this.FromBinary(t);case"hex":return this.FromHex(t);case"base64":return this.FromBase64(t);case"base64url":return this.FromBase64Url(t);case"utf16le":return a.fromString(t,true);case"utf16":case"utf16be":return a.fromString(t);default:throw new Error(`Unknown type of encoding '${e}'`)}}static ToBase64(t){const e=s.toUint8Array(t);if(typeof btoa!=="undefined"){const t=this.ToString(e,"binary");return btoa(t)}else{return Buffer.from(e).toString("base64")}}static FromBase64(t){const e=this.formatString(t);if(!e){return new ArrayBuffer(0)}if(!u.isBase64(e)){throw new TypeError("Argument 'base64Text' is not Base64 encoded")}if(typeof atob!=="undefined"){return this.FromBinary(atob(e))}else{return new Uint8Array(Buffer.from(e,"base64")).buffer}}static FromBase64Url(t){const e=this.formatString(t);if(!e){return new ArrayBuffer(0)}if(!u.isBase64Url(e)){throw new TypeError("Argument 'base64url' is not Base64Url encoded")}return this.FromBase64(this.Base64Padding(e.replace(/\-/g,"+").replace(/\_/g,"/")))}static ToBase64Url(t){return this.ToBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}static FromUtf8String(t,e=u.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.FromBinary(t);case"utf8":return c.fromString(t);case"utf16":case"utf16be":return a.fromString(t);case"utf16le":case"usc2":return a.fromString(t,true);default:throw new Error(`Unknown type of encoding '${e}'`)}}static ToUtf8String(t,e=u.DEFAULT_UTF8_ENCODING){switch(e){case"ascii":return this.ToBinary(t);case"utf8":return c.toString(t);case"utf16":case"utf16be":return a.toString(t);case"utf16le":case"usc2":return a.toString(t,true);default:throw new Error(`Unknown type of encoding '${e}'`)}}static FromBinary(t){const e=t.length;const s=new Uint8Array(e);for(let r=0;r<e;r++){s[r]=t.charCodeAt(r)}return s.buffer}static ToBinary(t){const e=s.toUint8Array(t);let r="";for(let t=0;t<e.length;t++){r+=String.fromCharCode(e[t])}return r}static ToHex(t){const e=s.toUint8Array(t);let r="";const i=e.length;for(let t=0;t<i;t++){const s=e[t];if(s<16){r+="0"}r+=s.toString(16)}return r}static FromHex(t){let e=this.formatString(t);if(!e){return new ArrayBuffer(0)}if(!u.isHex(e)){throw new TypeError("Argument 'hexString' is not HEX encoded")}if(e.length%2){e=`0${e}`}const s=new Uint8Array(e.length/2);for(let t=0;t<e.length;t=t+2){const r=e.slice(t,t+2);s[t/2]=parseInt(r,16)}return s.buffer}static ToUtf16String(t,e=false){return a.toString(t,e)}static FromUtf16String(t,e=false){return a.fromString(t,e)}static Base64Padding(t){const e=4-t.length%4;if(e<4){for(let s=0;s<e;s++){t+="="}}return t}static formatString(t){return(t===null||t===void 0?void 0:t.replace(/[\n\r\t ]/g,""))||""}}u.DEFAULT_UTF8_ENCODING="utf8";function l(t,e){if(!(t&&e)){return false}if(t.byteLength!==e.byteLength){return false}const s=new Uint8Array(t);const r=new Uint8Array(e);for(let e=0;e<t.byteLength;e++){if(s[e]!==r[e]){return false}}return true}var h=s;var f=u;var d=l;
/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */class p{}p.cert={asPEM:(e,s)=>{t(f.FromString(e),s,"cer","application/pkix-cert")},asDER:(e,s)=>{t(f.FromString(e),s,"cer","application/pkix-cert")}};p.attrCert={asPEM:(e,s)=>{t(f.FromString(e),s,"cer","application/pkix-attr-cert")},asDER:(e,s)=>{t(f.FromString(e),s,"cer","application/pkix-attr-cert")}};p.csr={asPEM:(e,s)=>{t(f.FromString(e),s,"csr","application/pkcs10")},asDER:(e,s)=>{t(f.FromString(e),s,"csr","application/pkcs10")}};p.crl={asPEM:(e,s)=>{t(f.FromString(e),s,"crl","application/pkix-crl")},asDER:(e,s)=>{t(f.FromString(e),s,"crl","application/pkix-crl")}};function y(t,e,s,r){var i=arguments.length,n=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,s):r,o;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")n=Reflect.decorate(t,e,s,r);else for(var c=t.length-1;c>=0;c--)if(o=t[c])n=(i<3?o(n):i>3?o(e,s,n):o(e,s))||n;return i>3&&n&&Object.defineProperty(e,s,n),n}typeof SuppressedError==="function"?SuppressedError:function(t,e,s){var r=new Error(s);return r.name="SuppressedError",r.error=t,r.suppressed=e,r};
/*!
 Copyright (c) Peculiar Ventures, LLC
*/function v(t,e){let s=0;if(t.length===1){return t[0]}for(let r=t.length-1;r>=0;r--){s+=t[t.length-1-r]*Math.pow(2,e*r)}return s}function w(t,e,s=-1){const r=s;let i=t;let n=0;let o=Math.pow(2,e);for(let s=1;s<8;s++){if(t<o){let t;if(r<0){t=new ArrayBuffer(s);n=s}else{if(r<s){return new ArrayBuffer(0)}t=new ArrayBuffer(r);n=r}const o=new Uint8Array(t);for(let t=s-1;t>=0;t--){const s=Math.pow(2,t*e);o[n-t-1]=Math.floor(i/s);i-=o[n-t-1]*s}return t}o*=Math.pow(2,e)}return new ArrayBuffer(0)}function g(...t){let e=0;let s=0;for(const s of t){e+=s.length}const r=new ArrayBuffer(e);const i=new Uint8Array(r);for(const e of t){i.set(e,s);s+=e.length}return i}function m(){const t=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){const e=t[0]===255&&t[1]&128;const s=t[0]===0&&(t[1]&128)===0;if(e||s){this.warnings.push("Needlessly long format")}}const e=new ArrayBuffer(this.valueHex.byteLength);const s=new Uint8Array(e);for(let t=0;t<this.valueHex.byteLength;t++){s[t]=0}s[0]=t[0]&128;const r=v(s,8);const i=new ArrayBuffer(this.valueHex.byteLength);const n=new Uint8Array(i);for(let e=0;e<this.valueHex.byteLength;e++){n[e]=t[e]}n[0]&=127;const o=v(n,8);return o-r}function b(t){const e=t<0?t*-1:t;let s=128;for(let r=1;r<8;r++){if(e<=s){if(t<0){const t=s-e;const i=w(t,8,r);const n=new Uint8Array(i);n[0]|=128;return i}let i=w(e,8,r);let n=new Uint8Array(i);if(n[0]&128){const t=i.slice(0);const e=new Uint8Array(t);i=new ArrayBuffer(i.byteLength+1);n=new Uint8Array(i);for(let s=0;s<t.byteLength;s++){n[s+1]=e[s]}n[0]=0}return i}s*=Math.pow(2,8)}return new ArrayBuffer(0)}function x(t,e){if(t.byteLength!==e.byteLength){return false}const s=new Uint8Array(t);const r=new Uint8Array(e);for(let t=0;t<s.length;t++){if(s[t]!==r[t]){return false}}return true}function S(t,e){const s=t.toString(10);if(e<s.length){return""}const r=e-s.length;const i=new Array(r);for(let t=0;t<r;t++){i[t]="0"}const n=i.join("");return n.concat(s)}
/*!
 * Copyright (c) 2014, GMO GlobalSign
 * Copyright (c) 2015-2022, Peculiar Ventures
 * All rights reserved.
 * 
 * Author 2014-2019, Yury Strozhevsky
 * 
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 * 
 * * Redistributions of source code must retain the above copyright notice, this
 *   list of conditions and the following disclaimer.
 * 
 * * Redistributions in binary form must reproduce the above copyright notice, this
 *   list of conditions and the following disclaimer in the documentation and/or
 *   other materials provided with the distribution.
 * 
 * * Neither the name of the copyright holder nor the names of its
 *   contributors may be used to endorse or promote products derived from
 *   this software without specific prior written permission.
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 * 
 */function A(){if(typeof BigInt==="undefined"){throw new Error("BigInt is not defined. Your environment doesn't implement BigInt.")}}function B(t){let e=0;let s=0;for(let s=0;s<t.length;s++){const r=t[s];e+=r.byteLength}const r=new Uint8Array(e);for(let e=0;e<t.length;e++){const i=t[e];r.set(new Uint8Array(i),s);s+=i.byteLength}return r.buffer}function E(t,e,s,r){if(!(e instanceof Uint8Array)){t.error="Wrong parameter: inputBuffer must be 'Uint8Array'";return false}if(!e.byteLength){t.error="Wrong parameter: inputBuffer has zero length";return false}if(s<0){t.error="Wrong parameter: inputOffset less than zero";return false}if(r<0){t.error="Wrong parameter: inputLength less than zero";return false}if(e.byteLength-s-r<0){t.error="End of input reached before message was fully decoded (inconsistent offset and length values)";return false}return true}class O{constructor(){this.items=[]}write(t){this.items.push(t)}final(){return B(this.items)}}const I=[new Uint8Array([1])];const k="0123456789";const N="name";const U="valueHexView";const $="isHexOnly";const j="idBlock";const T="tagClass";const R="tagNumber";const C="isConstructed";const D="fromBER";const V="toBER";const P="local";const M="";const q=new ArrayBuffer(0);const L=new Uint8Array(0);const W="EndOfContent";const H="OCTET STRING";const F="BIT STRING";function J(t){var e;return e=class e extends t{constructor(...t){var e;super(...t);const s=t[0]||{};this.isHexOnly=(e=s.isHexOnly)!==null&&e!==void 0?e:false;this.valueHexView=s.valueHex?h.toUint8Array(s.valueHex):L}get valueHex(){return this.valueHexView.slice().buffer}set valueHex(t){this.valueHexView=new Uint8Array(t)}fromBER(t,e,s){const r=t instanceof ArrayBuffer?new Uint8Array(t):t;if(!E(this,r,e,s)){return-1}const i=e+s;this.valueHexView=r.subarray(e,i);if(!this.valueHexView.length){this.warnings.push("Zero buffer length");return e}this.blockLength=s;return i}toBER(t=false){if(!this.isHexOnly){this.error="Flag 'isHexOnly' is not set, abort";return q}if(t){return new ArrayBuffer(this.valueHexView.byteLength)}return this.valueHexView.byteLength===this.valueHexView.buffer.byteLength?this.valueHexView.buffer:this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isHexOnly:this.isHexOnly,valueHex:f.ToHex(this.valueHexView)}}},e.NAME="hexBlock",e}class z{constructor({blockLength:t=0,error:e=M,warnings:s=[],valueBeforeDecode:r=L}={}){this.blockLength=t;this.error=e;this.warnings=s;this.valueBeforeDecodeView=h.toUint8Array(r)}static blockName(){return this.NAME}get valueBeforeDecode(){return this.valueBeforeDecodeView.slice().buffer}set valueBeforeDecode(t){this.valueBeforeDecodeView=new Uint8Array(t)}toJSON(){return{blockName:this.constructor.NAME,blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:f.ToHex(this.valueBeforeDecodeView)}}}z.NAME="baseBlock";class G extends z{fromBER(t,e,s){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}toBER(t,e){throw TypeError("User need to make a specific function in a class which extends 'ValueBlock'")}}G.NAME="valueBlock";class Z extends(J(z)){constructor({idBlock:t={}}={}){var e,s,r,i;super();if(t){this.isHexOnly=(e=t.isHexOnly)!==null&&e!==void 0?e:false;this.valueHexView=t.valueHex?h.toUint8Array(t.valueHex):L;this.tagClass=(s=t.tagClass)!==null&&s!==void 0?s:-1;this.tagNumber=(r=t.tagNumber)!==null&&r!==void 0?r:-1;this.isConstructed=(i=t.isConstructed)!==null&&i!==void 0?i:false}else{this.tagClass=-1;this.tagNumber=-1;this.isConstructed=false}}toBER(t=false){let e=0;switch(this.tagClass){case 1:e|=0;break;case 2:e|=64;break;case 3:e|=128;break;case 4:e|=192;break;default:this.error="Unknown tag class";return q}if(this.isConstructed)e|=32;if(this.tagNumber<31&&!this.isHexOnly){const s=new Uint8Array(1);if(!t){let t=this.tagNumber;t&=31;e|=t;s[0]=e}return s.buffer}if(!this.isHexOnly){const s=w(this.tagNumber,7);const r=new Uint8Array(s);const i=s.byteLength;const n=new Uint8Array(i+1);n[0]=e|31;if(!t){for(let t=0;t<i-1;t++)n[t+1]=r[t]|128;n[i]=r[i-1]}return n.buffer}const s=new Uint8Array(this.valueHexView.byteLength+1);s[0]=e|31;if(!t){const t=this.valueHexView;for(let e=0;e<t.length-1;e++)s[e+1]=t[e]|128;s[this.valueHexView.byteLength]=t[t.length-1]}return s.buffer}fromBER(t,e,s){const r=h.toUint8Array(t);if(!E(this,r,e,s)){return-1}const i=r.subarray(e,e+s);if(i.length===0){this.error="Zero buffer length";return-1}const n=i[0]&192;switch(n){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:this.error="Unknown tag class";return-1}this.isConstructed=(i[0]&32)===32;this.isHexOnly=false;const o=i[0]&31;if(o!==31){this.tagNumber=o;this.blockLength=1}else{let t=1;let e=this.valueHexView=new Uint8Array(255);let s=255;while(i[t]&128){e[t-1]=i[t]&127;t++;if(t>=i.length){this.error="End of input reached before message was fully decoded";return-1}if(t===s){s+=255;const t=new Uint8Array(s);for(let s=0;s<e.length;s++)t[s]=e[s];e=this.valueHexView=new Uint8Array(s)}}this.blockLength=t+1;e[t-1]=i[t]&127;const r=new Uint8Array(t);for(let s=0;s<t;s++)r[s]=e[s];e=this.valueHexView=new Uint8Array(t);e.set(r);if(this.blockLength<=9)this.tagNumber=v(e,7);else{this.isHexOnly=true;this.warnings.push("Tag too long, represented as hex-coded")}}if(this.tagClass===1&&this.isConstructed){switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:this.error="Constructed encoding used for primitive type";return-1}}return e+this.blockLength}toJSON(){return{...super.toJSON(),tagClass:this.tagClass,tagNumber:this.tagNumber,isConstructed:this.isConstructed}}}Z.NAME="identificationBlock";class K extends z{constructor({lenBlock:t={}}={}){var e,s,r;super();this.isIndefiniteForm=(e=t.isIndefiniteForm)!==null&&e!==void 0?e:false;this.longFormUsed=(s=t.longFormUsed)!==null&&s!==void 0?s:false;this.length=(r=t.length)!==null&&r!==void 0?r:0}fromBER(t,e,s){const r=h.toUint8Array(t);if(!E(this,r,e,s)){return-1}const i=r.subarray(e,e+s);if(i.length===0){this.error="Zero buffer length";return-1}if(i[0]===255){this.error="Length block 0xFF is reserved by standard";return-1}this.isIndefiniteForm=i[0]===128;if(this.isIndefiniteForm){this.blockLength=1;return e+this.blockLength}this.longFormUsed=!!(i[0]&128);if(this.longFormUsed===false){this.length=i[0];this.blockLength=1;return e+this.blockLength}const n=i[0]&127;if(n>8){this.error="Too big integer";return-1}if(n+1>i.length){this.error="End of input reached before message was fully decoded";return-1}const o=e+1;const c=r.subarray(o,o+n);if(c[n-1]===0)this.warnings.push("Needlessly long encoded length");this.length=v(c,8);if(this.longFormUsed&&this.length<=127)this.warnings.push("Unnecessary usage of long length form");this.blockLength=n+1;return e+this.blockLength}toBER(t=false){let e;let s;if(this.length>127)this.longFormUsed=true;if(this.isIndefiniteForm){e=new ArrayBuffer(1);if(t===false){s=new Uint8Array(e);s[0]=128}return e}if(this.longFormUsed){const r=w(this.length,8);if(r.byteLength>127){this.error="Too big length";return q}e=new ArrayBuffer(r.byteLength+1);if(t)return e;const i=new Uint8Array(r);s=new Uint8Array(e);s[0]=r.byteLength|128;for(let t=0;t<r.byteLength;t++)s[t+1]=i[t];return e}e=new ArrayBuffer(1);if(t===false){s=new Uint8Array(e);s[0]=this.length}return e}toJSON(){return{...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,longFormUsed:this.longFormUsed,length:this.length}}}K.NAME="lengthBlock";const _={};class Q extends z{constructor({name:t=M,optional:e=false,primitiveSchema:s,...r}={},i){super(r);this.name=t;this.optional=e;if(s){this.primitiveSchema=s}this.idBlock=new Z(r);this.lenBlock=new K(r);this.valueBlock=i?new i(r):new G(r)}fromBER(t,e,s){const r=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?s:this.lenBlock.length);if(r===-1){this.error=this.valueBlock.error;return r}if(!this.idBlock.error.length)this.blockLength+=this.idBlock.blockLength;if(!this.lenBlock.error.length)this.blockLength+=this.lenBlock.blockLength;if(!this.valueBlock.error.length)this.blockLength+=this.valueBlock.blockLength;return r}toBER(t,e){const s=e||new O;if(!e){X(this)}const r=this.idBlock.toBER(t);s.write(r);if(this.lenBlock.isIndefiniteForm){s.write(new Uint8Array([128]).buffer);this.valueBlock.toBER(t,s);s.write(new ArrayBuffer(2))}else{const e=this.valueBlock.toBER(t);this.lenBlock.length=e.byteLength;const r=this.lenBlock.toBER(t);s.write(r);s.write(e)}if(!e){return s.final()}return q}toJSON(){const t={...super.toJSON(),idBlock:this.idBlock.toJSON(),lenBlock:this.lenBlock.toJSON(),valueBlock:this.valueBlock.toJSON(),name:this.name,optional:this.optional};if(this.primitiveSchema)t.primitiveSchema=this.primitiveSchema.toJSON();return t}toString(t="ascii"){if(t==="ascii"){return this.onAsciiEncoding()}return f.ToHex(this.toBER())}onAsciiEncoding(){return`${this.constructor.NAME} : ${f.ToHex(this.valueBlock.valueBeforeDecodeView)}`}isEqual(t){if(this===t){return true}if(!(t instanceof this.constructor)){return false}const e=this.toBER();const s=t.toBER();return x(e,s)}}Q.NAME="BaseBlock";function X(t){if(t instanceof _.Constructed){for(const e of t.valueBlock.value){if(X(e)){t.lenBlock.isIndefiniteForm=true}}}return!!t.lenBlock.isIndefiniteForm}class Y extends Q{constructor({value:t=M,...e}={},s){super(e,s);if(t){this.fromString(t)}}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}fromBER(t,e,s){const r=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?s:this.lenBlock.length);if(r===-1){this.error=this.valueBlock.error;return r}this.fromBuffer(this.valueBlock.valueHexView);if(!this.idBlock.error.length)this.blockLength+=this.idBlock.blockLength;if(!this.lenBlock.error.length)this.blockLength+=this.lenBlock.blockLength;if(!this.valueBlock.error.length)this.blockLength+=this.valueBlock.blockLength;return r}onAsciiEncoding(){return`${this.constructor.NAME} : '${this.valueBlock.value}'`}}Y.NAME="BaseStringBlock";class tt extends(J(G)){constructor({isHexOnly:t=true,...e}={}){super(e);this.isHexOnly=t}}tt.NAME="PrimitiveValueBlock";var et;class st extends Q{constructor(t={}){super(t,tt);this.idBlock.isConstructed=false}}et=st;(()=>{_.Primitive=et})();st.NAME="PRIMITIVE";function rt(t,e){if(t instanceof e){return t}const s=new e;s.idBlock=t.idBlock;s.lenBlock=t.lenBlock;s.warnings=t.warnings;s.valueBeforeDecodeView=t.valueBeforeDecodeView;return s}function it(t,e=0,s=t.length){const r=e;let i=new Q({},G);const n=new z;if(!E(n,t,e,s)){i.error=n.error;return{offset:-1,result:i}}const o=t.subarray(e,e+s);if(!o.length){i.error="Zero buffer length";return{offset:-1,result:i}}let c=i.idBlock.fromBER(t,e,s);if(i.idBlock.warnings.length){i.warnings.concat(i.idBlock.warnings)}if(c===-1){i.error=i.idBlock.error;return{offset:-1,result:i}}e=c;s-=i.idBlock.blockLength;c=i.lenBlock.fromBER(t,e,s);if(i.lenBlock.warnings.length){i.warnings.concat(i.lenBlock.warnings)}if(c===-1){i.error=i.lenBlock.error;return{offset:-1,result:i}}e=c;s-=i.lenBlock.blockLength;if(!i.idBlock.isConstructed&&i.lenBlock.isIndefiniteForm){i.error="Indefinite length form used for primitive encoding form";return{offset:-1,result:i}}let a=Q;switch(i.idBlock.tagClass){case 1:if(i.idBlock.tagNumber>=37&&i.idBlock.isHexOnly===false){i.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard";return{offset:-1,result:i}}switch(i.idBlock.tagNumber){case 0:if(i.idBlock.isConstructed&&i.lenBlock.length>0){i.error="Type [UNIVERSAL 0] is reserved";return{offset:-1,result:i}}a=_.EndOfContent;break;case 1:a=_.Boolean;break;case 2:a=_.Integer;break;case 3:a=_.BitString;break;case 4:a=_.OctetString;break;case 5:a=_.Null;break;case 6:a=_.ObjectIdentifier;break;case 10:a=_.Enumerated;break;case 12:a=_.Utf8String;break;case 13:a=_.RelativeObjectIdentifier;break;case 14:a=_.TIME;break;case 15:i.error="[UNIVERSAL 15] is reserved by ASN.1 standard";return{offset:-1,result:i};case 16:a=_.Sequence;break;case 17:a=_.Set;break;case 18:a=_.NumericString;break;case 19:a=_.PrintableString;break;case 20:a=_.TeletexString;break;case 21:a=_.VideotexString;break;case 22:a=_.IA5String;break;case 23:a=_.UTCTime;break;case 24:a=_.GeneralizedTime;break;case 25:a=_.GraphicString;break;case 26:a=_.VisibleString;break;case 27:a=_.GeneralString;break;case 28:a=_.UniversalString;break;case 29:a=_.CharacterString;break;case 30:a=_.BmpString;break;case 31:a=_.DATE;break;case 32:a=_.TimeOfDay;break;case 33:a=_.DateTime;break;case 34:a=_.Duration;break;default:{const t=i.idBlock.isConstructed?new _.Constructed:new _.Primitive;t.idBlock=i.idBlock;t.lenBlock=i.lenBlock;t.warnings=i.warnings;i=t}}break;case 2:case 3:case 4:default:{a=i.idBlock.isConstructed?_.Constructed:_.Primitive}}i=rt(i,a);c=i.fromBER(t,e,i.lenBlock.isIndefiniteForm?s:i.lenBlock.length);i.valueBeforeDecodeView=t.subarray(r,r+i.blockLength);return{offset:c,result:i}}function nt(t){if(!t.byteLength){const t=new Q({},G);t.error="Input buffer has zero length";return{offset:-1,result:t}}return it(h.toUint8Array(t).slice(),0,t.byteLength)}function ot(t,e){if(t){return 1}return e}class ct extends G{constructor({value:t=[],isIndefiniteForm:e=false,...s}={}){super(s);this.value=t;this.isIndefiniteForm=e}fromBER(t,e,s){const r=h.toUint8Array(t);if(!E(this,r,e,s)){return-1}this.valueBeforeDecodeView=r.subarray(e,e+s);if(this.valueBeforeDecodeView.length===0){this.warnings.push("Zero buffer length");return e}let i=e;while(ot(this.isIndefiniteForm,s)>0){const t=it(r,i,s);if(t.offset===-1){this.error=t.result.error;this.warnings.concat(t.result.warnings);return-1}i=t.offset;this.blockLength+=t.result.blockLength;s-=t.result.blockLength;this.value.push(t.result);if(this.isIndefiniteForm&&t.result.constructor.NAME===W){break}}if(this.isIndefiniteForm){if(this.value[this.value.length-1].constructor.NAME===W){this.value.pop()}else{this.warnings.push("No EndOfContent block encoded")}}return i}toBER(t,e){const s=e||new O;for(let e=0;e<this.value.length;e++){this.value[e].toBER(t,s)}if(!e){return s.final()}return q}toJSON(){const t={...super.toJSON(),isIndefiniteForm:this.isIndefiniteForm,value:[]};for(const e of this.value){t.value.push(e.toJSON())}return t}}ct.NAME="ConstructedValueBlock";var at;class ut extends Q{constructor(t={}){super(t,ct);this.idBlock.isConstructed=true}fromBER(t,e,s){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;const r=this.valueBlock.fromBER(t,e,this.lenBlock.isIndefiniteForm?s:this.lenBlock.length);if(r===-1){this.error=this.valueBlock.error;return r}if(!this.idBlock.error.length)this.blockLength+=this.idBlock.blockLength;if(!this.lenBlock.error.length)this.blockLength+=this.lenBlock.blockLength;if(!this.valueBlock.error.length)this.blockLength+=this.valueBlock.blockLength;return r}onAsciiEncoding(){const t=[];for(const e of this.valueBlock.value){t.push(e.toString("ascii").split("\n").map((t=>`  ${t}`)).join("\n"))}const e=this.idBlock.tagClass===3?`[${this.idBlock.tagNumber}]`:this.constructor.NAME;return t.length?`${e} :\n${t.join("\n")}`:`${e} :`}}at=ut;(()=>{_.Constructed=at})();ut.NAME="CONSTRUCTED";class lt extends G{fromBER(t,e,s){return e}toBER(t){return q}}lt.override="EndOfContentValueBlock";var ht;class ft extends Q{constructor(t={}){super(t,lt);this.idBlock.tagClass=1;this.idBlock.tagNumber=0}}ht=ft;(()=>{_.EndOfContent=ht})();ft.NAME=W;var dt;class pt extends Q{constructor(t={}){super(t,G);this.idBlock.tagClass=1;this.idBlock.tagNumber=5}fromBER(t,e,s){if(this.lenBlock.length>0)this.warnings.push("Non-zero length of value block for Null type");if(!this.idBlock.error.length)this.blockLength+=this.idBlock.blockLength;if(!this.lenBlock.error.length)this.blockLength+=this.lenBlock.blockLength;this.blockLength+=s;if(e+s>t.byteLength){this.error="End of input reached before message was fully decoded (inconsistent offset and length values)";return-1}return e+s}toBER(t,e){const s=new ArrayBuffer(2);if(!t){const t=new Uint8Array(s);t[0]=5;t[1]=0}if(e){e.write(s)}return s}onAsciiEncoding(){return`${this.constructor.NAME}`}}dt=pt;(()=>{_.Null=dt})();pt.NAME="NULL";class yt extends(J(G)){constructor({value:t,...e}={}){super(e);if(e.valueHex){this.valueHexView=h.toUint8Array(e.valueHex)}else{this.valueHexView=new Uint8Array(1)}if(t){this.value=t}}get value(){for(const t of this.valueHexView){if(t>0){return true}}return false}set value(t){this.valueHexView[0]=t?255:0}fromBER(t,e,s){const r=h.toUint8Array(t);if(!E(this,r,e,s)){return-1}this.valueHexView=r.subarray(e,e+s);if(s>1)this.warnings.push("Boolean value encoded in more then 1 octet");this.isHexOnly=true;m.call(this);this.blockLength=s;return e+s}toBER(){return this.valueHexView.slice()}toJSON(){return{...super.toJSON(),value:this.value}}}yt.NAME="BooleanValueBlock";var vt;class wt extends Q{constructor(t={}){super(t,yt);this.idBlock.tagClass=1;this.idBlock.tagNumber=1}getValue(){return this.valueBlock.value}setValue(t){this.valueBlock.value=t}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.getValue}`}}vt=wt;(()=>{_.Boolean=vt})();wt.NAME="BOOLEAN";class gt extends(J(ct)){constructor({isConstructed:t=false,...e}={}){super(e);this.isConstructed=t}fromBER(t,e,s){let r=0;if(this.isConstructed){this.isHexOnly=false;r=ct.prototype.fromBER.call(this,t,e,s);if(r===-1)return r;for(let t=0;t<this.value.length;t++){const e=this.value[t].constructor.NAME;if(e===W){if(this.isIndefiniteForm)break;else{this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only";return-1}}if(e!==H){this.error="OCTET STRING may consists of OCTET STRINGs only";return-1}}}else{this.isHexOnly=true;r=super.fromBER(t,e,s);this.blockLength=s}return r}toBER(t,e){if(this.isConstructed)return ct.prototype.toBER.call(this,t,e);return t?new ArrayBuffer(this.valueHexView.byteLength):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),isConstructed:this.isConstructed}}}gt.NAME="OctetStringValueBlock";var mt;class bt extends Q{constructor({idBlock:t={},lenBlock:e={},...s}={}){var r,i;(r=s.isConstructed)!==null&&r!==void 0?r:s.isConstructed=!!((i=s.value)===null||i===void 0?void 0:i.length);super({idBlock:{isConstructed:s.isConstructed,...t},lenBlock:{...e,isIndefiniteForm:!!s.isIndefiniteForm},...s},gt);this.idBlock.tagClass=1;this.idBlock.tagNumber=4}fromBER(t,e,s){this.valueBlock.isConstructed=this.idBlock.isConstructed;this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;if(s===0){if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;return e}if(!this.valueBlock.isConstructed){const r=t instanceof ArrayBuffer?new Uint8Array(t):t;const i=r.subarray(e,e+s);try{if(i.byteLength){const t=it(i,0,i.byteLength);if(t.offset!==-1&&t.offset===s){this.valueBlock.value=[t.result]}}}catch(t){}}return super.fromBER(t,e,s)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length){return ut.prototype.onAsciiEncoding.call(this)}return`${this.constructor.NAME} : ${f.ToHex(this.valueBlock.valueHexView)}`}getValue(){if(!this.idBlock.isConstructed){return this.valueBlock.valueHexView.slice().buffer}const t=[];for(const e of this.valueBlock.value){if(e instanceof bt){t.push(e.valueBlock.valueHexView)}}return h.concat(t)}}mt=bt;(()=>{_.OctetString=mt})();bt.NAME=H;class xt extends(J(ct)){constructor({unusedBits:t=0,isConstructed:e=false,...s}={}){super(s);this.unusedBits=t;this.isConstructed=e;this.blockLength=this.valueHexView.byteLength}fromBER(t,e,s){if(!s){return e}let r=-1;if(this.isConstructed){r=ct.prototype.fromBER.call(this,t,e,s);if(r===-1)return r;for(const t of this.value){const e=t.constructor.NAME;if(e===W){if(this.isIndefiniteForm)break;else{this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only";return-1}}if(e!==F){this.error="BIT STRING may consists of BIT STRINGs only";return-1}const s=t.valueBlock;if(this.unusedBits>0&&s.unusedBits>0){this.error='Using of "unused bits" inside constructive BIT STRING allowed for least one only';return-1}this.unusedBits=s.unusedBits}return r}const i=h.toUint8Array(t);if(!E(this,i,e,s)){return-1}const n=i.subarray(e,e+s);this.unusedBits=n[0];if(this.unusedBits>7){this.error="Unused bits for BitString must be in range 0-7";return-1}if(!this.unusedBits){const t=n.subarray(1);try{if(t.byteLength){const e=it(t,0,t.byteLength);if(e.offset!==-1&&e.offset===s-1){this.value=[e.result]}}}catch(t){}}this.valueHexView=n.subarray(1);this.blockLength=n.length;return e+s}toBER(t,e){if(this.isConstructed){return ct.prototype.toBER.call(this,t,e)}if(t){return new ArrayBuffer(this.valueHexView.byteLength+1)}if(!this.valueHexView.byteLength){return q}const s=new Uint8Array(this.valueHexView.length+1);s[0]=this.unusedBits;s.set(this.valueHexView,1);return s.buffer}toJSON(){return{...super.toJSON(),unusedBits:this.unusedBits,isConstructed:this.isConstructed}}}xt.NAME="BitStringValueBlock";var St;class At extends Q{constructor({idBlock:t={},lenBlock:e={},...s}={}){var r,i;(r=s.isConstructed)!==null&&r!==void 0?r:s.isConstructed=!!((i=s.value)===null||i===void 0?void 0:i.length);super({idBlock:{isConstructed:s.isConstructed,...t},lenBlock:{...e,isIndefiniteForm:!!s.isIndefiniteForm},...s},xt);this.idBlock.tagClass=1;this.idBlock.tagNumber=3}fromBER(t,e,s){this.valueBlock.isConstructed=this.idBlock.isConstructed;this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;return super.fromBER(t,e,s)}onAsciiEncoding(){if(this.valueBlock.isConstructed||this.valueBlock.value&&this.valueBlock.value.length){return ut.prototype.onAsciiEncoding.call(this)}else{const t=[];const e=this.valueBlock.valueHexView;for(const s of e){t.push(s.toString(2).padStart(8,"0"))}const s=t.join("");return`${this.constructor.NAME} : ${s.substring(0,s.length-this.valueBlock.unusedBits)}`}}}St=At;(()=>{_.BitString=St})();At.NAME=F;var Bt;function Et(t,e){const s=new Uint8Array([0]);const r=new Uint8Array(t);const i=new Uint8Array(e);let n=r.slice(0);const o=n.length-1;const c=i.slice(0);const a=c.length-1;let u=0;const l=a<o?o:a;let h=0;for(let t=l;t>=0;t--,h++){switch(true){case h<c.length:u=n[o-h]+c[a-h]+s[0];break;default:u=n[o-h]+s[0]}s[0]=u/10;switch(true){case h>=n.length:n=g(new Uint8Array([u%10]),n);break;default:n[o-h]=u%10}}if(s[0]>0)n=g(s,n);return n}function Ot(t){if(t>=I.length){for(let e=I.length;e<=t;e++){const t=new Uint8Array([0]);let s=I[e-1].slice(0);for(let e=s.length-1;e>=0;e--){const r=new Uint8Array([(s[e]<<1)+t[0]]);t[0]=r[0]/10;s[e]=r[0]%10}if(t[0]>0)s=g(t,s);I.push(s)}}return I[t]}function It(t,e){let s=0;const r=new Uint8Array(t);const i=new Uint8Array(e);const n=r.slice(0);const o=n.length-1;const c=i.slice(0);const a=c.length-1;let u;let l=0;for(let t=a;t>=0;t--,l++){u=n[o-l]-c[a-l]-s;switch(true){case u<0:s=1;n[o-l]=u+10;break;default:s=0;n[o-l]=u}}if(s>0){for(let t=o-a+1;t>=0;t--,l++){u=n[o-l]-s;if(u<0){s=1;n[o-l]=u+10}else{s=0;n[o-l]=u;break}}}return n.slice()}class kt extends(J(G)){constructor({value:t,...e}={}){super(e);this._valueDec=0;if(e.valueHex){this.setValueHex()}if(t!==undefined){this.valueDec=t}}setValueHex(){if(this.valueHexView.length>=4){this.warnings.push("Too big Integer for decoding, hex only");this.isHexOnly=true;this._valueDec=0}else{this.isHexOnly=false;if(this.valueHexView.length>0){this._valueDec=m.call(this)}}}set valueDec(t){this._valueDec=t;this.isHexOnly=false;this.valueHexView=new Uint8Array(b(t))}get valueDec(){return this._valueDec}fromDER(t,e,s,r=0){const i=this.fromBER(t,e,s);if(i===-1)return i;const n=this.valueHexView;if(n[0]===0&&(n[1]&128)!==0){this.valueHexView=n.subarray(1)}else{if(r!==0){if(n.length<r){if(r-n.length>1)r=n.length+1;this.valueHexView=n.subarray(r-n.length)}}}return i}toDER(t=false){const e=this.valueHexView;switch(true){case(e[0]&128)!==0:{const t=new Uint8Array(this.valueHexView.length+1);t[0]=0;t.set(e,1);this.valueHexView=t}break;case e[0]===0&&(e[1]&128)===0:{this.valueHexView=this.valueHexView.subarray(1)}break}return this.toBER(t)}fromBER(t,e,s){const r=super.fromBER(t,e,s);if(r===-1){return r}this.setValueHex();return r}toBER(t){return t?new ArrayBuffer(this.valueHexView.length):this.valueHexView.slice().buffer}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}toString(){const t=this.valueHexView.length*8-1;let e=new Uint8Array(this.valueHexView.length*8/3);let s=0;let r;const i=this.valueHexView;let n="";let o=false;for(let o=i.byteLength-1;o>=0;o--){r=i[o];for(let i=0;i<8;i++){if((r&1)===1){switch(s){case t:e=It(Ot(s),e);n="-";break;default:e=Et(e,Ot(s))}}s++;r>>=1}}for(let t=0;t<e.length;t++){if(e[t])o=true;if(o)n+=k.charAt(e[t])}if(o===false)n+=k.charAt(0);return n}}Bt=kt;kt.NAME="IntegerValueBlock";(()=>{Object.defineProperty(Bt.prototype,"valueHex",{set:function(t){this.valueHexView=new Uint8Array(t);this.setValueHex()},get:function(){return this.valueHexView.slice().buffer}})})();var Nt;class Ut extends Q{constructor(t={}){super(t,kt);this.idBlock.tagClass=1;this.idBlock.tagNumber=2}toBigInt(){A();return BigInt(this.valueBlock.toString())}static fromBigInt(t){A();const e=BigInt(t);const s=new O;const r=e.toString(16).replace(/^-/,"");const i=new Uint8Array(f.FromHex(r));if(e<0){const t=new Uint8Array(i.length+(i[0]&128?1:0));t[0]|=128;const r=BigInt(`0x${f.ToHex(t)}`);const n=r+e;const o=h.toUint8Array(f.FromHex(n.toString(16)));o[0]|=128;s.write(o)}else{if(i[0]&128){s.write(new Uint8Array([0]))}s.write(i)}const n=new Ut({valueHex:s.final()});return n}convertToDER(){const t=new Ut({valueHex:this.valueBlock.valueHexView});t.valueBlock.toDER();return t}convertFromDER(){return new Ut({valueHex:this.valueBlock.valueHexView[0]===0?this.valueBlock.valueHexView.subarray(1):this.valueBlock.valueHexView})}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()}`}}Nt=Ut;(()=>{_.Integer=Nt})();Ut.NAME="INTEGER";var $t;class jt extends Ut{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=10}}$t=jt;(()=>{_.Enumerated=$t})();jt.NAME="ENUMERATED";class Tt extends(J(G)){constructor({valueDec:t=-1,isFirstSid:e=false,...s}={}){super(s);this.valueDec=t;this.isFirstSid=e}fromBER(t,e,s){if(!s){return e}const r=h.toUint8Array(t);if(!E(this,r,e,s)){return-1}const i=r.subarray(e,e+s);this.valueHexView=new Uint8Array(s);for(let t=0;t<s;t++){this.valueHexView[t]=i[t]&127;this.blockLength++;if((i[t]&128)===0)break}const n=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength;t++){n[t]=this.valueHexView[t]}this.valueHexView=n;if((i[this.blockLength-1]&128)!==0){this.error="End of input reached before message was fully decoded";return-1}if(this.valueHexView[0]===0)this.warnings.push("Needlessly long format of SID encoding");if(this.blockLength<=8)this.valueDec=v(this.valueHexView,7);else{this.isHexOnly=true;this.warnings.push("Too big SID for decoding, hex only")}return e+this.blockLength}set valueBigInt(t){A();let e=BigInt(t).toString(2);while(e.length%7){e="0"+e}const s=new Uint8Array(e.length/7);for(let t=0;t<s.length;t++){s[t]=parseInt(e.slice(t*7,t*7+7),2)+(t+1<s.length?128:0)}this.fromBER(s.buffer,0,s.length)}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const e=this.valueHexView;const s=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength-1;t++)s[t]=e[t]|128;s[this.blockLength-1]=e[this.blockLength-1];return s.buffer}const e=w(this.valueDec,7);if(e.byteLength===0){this.error="Error during encoding SID value";return q}const s=new Uint8Array(e.byteLength);if(!t){const t=new Uint8Array(e);const r=e.byteLength-1;for(let e=0;e<r;e++)s[e]=t[e]|128;s[r]=t[r]}return s}toString(){let t="";if(this.isHexOnly)t=f.ToHex(this.valueHexView);else{if(this.isFirstSid){let e=this.valueDec;if(this.valueDec<=39)t="0.";else{if(this.valueDec<=79){t="1.";e-=40}else{t="2.";e-=80}}t+=e.toString()}else t=this.valueDec.toString()}return t}toJSON(){return{...super.toJSON(),valueDec:this.valueDec,isFirstSid:this.isFirstSid}}}Tt.NAME="sidBlock";class Rt extends G{constructor({value:t=M,...e}={}){super(e);this.value=[];if(t){this.fromString(t)}}fromBER(t,e,s){let r=e;while(s>0){const e=new Tt;r=e.fromBER(t,r,s);if(r===-1){this.blockLength=0;this.error=e.error;return r}if(this.value.length===0)e.isFirstSid=true;this.blockLength+=e.blockLength;s-=e.blockLength;this.value.push(e)}return r}toBER(t){const e=[];for(let s=0;s<this.value.length;s++){const r=this.value[s].toBER(t);if(r.byteLength===0){this.error=this.value[s].error;return q}e.push(r)}return B(e)}fromString(t){this.value=[];let e=0;let s=0;let r="";let i=false;do{s=t.indexOf(".",e);if(s===-1)r=t.substring(e);else r=t.substring(e,s);e=s+1;if(i){const t=this.value[0];let e=0;switch(t.valueDec){case 0:break;case 1:e=40;break;case 2:e=80;break;default:this.value=[];return}const s=parseInt(r,10);if(isNaN(s))return;t.valueDec=s+e;i=false}else{const t=new Tt;if(r>Number.MAX_SAFE_INTEGER){A();const e=BigInt(r);t.valueBigInt=e}else{t.valueDec=parseInt(r,10);if(isNaN(t.valueDec))return}if(!this.value.length){t.isFirstSid=true;i=true}this.value.push(t)}}while(s!==-1)}toString(){let t="";let e=false;for(let s=0;s<this.value.length;s++){e=this.value[s].isHexOnly;let r=this.value[s].toString();if(s!==0)t=`${t}.`;if(e){r=`{${r}}`;if(this.value[s].isFirstSid)t=`2.{${r} - 80}`;else t+=r}else t+=r}return t}toJSON(){const t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let e=0;e<this.value.length;e++){t.sidArray.push(this.value[e].toJSON())}return t}}Rt.NAME="ObjectIdentifierValueBlock";var Ct;class Dt extends Q{constructor(t={}){super(t,Rt);this.idBlock.tagClass=1;this.idBlock.tagNumber=6}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Ct=Dt;(()=>{_.ObjectIdentifier=Ct})();Dt.NAME="OBJECT IDENTIFIER";class Vt extends(J(z)){constructor({valueDec:t=0,...e}={}){super(e);this.valueDec=t}fromBER(t,e,s){if(s===0)return e;const r=h.toUint8Array(t);if(!E(this,r,e,s))return-1;const i=r.subarray(e,e+s);this.valueHexView=new Uint8Array(s);for(let t=0;t<s;t++){this.valueHexView[t]=i[t]&127;this.blockLength++;if((i[t]&128)===0)break}const n=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength;t++)n[t]=this.valueHexView[t];this.valueHexView=n;if((i[this.blockLength-1]&128)!==0){this.error="End of input reached before message was fully decoded";return-1}if(this.valueHexView[0]===0)this.warnings.push("Needlessly long format of SID encoding");if(this.blockLength<=8)this.valueDec=v(this.valueHexView,7);else{this.isHexOnly=true;this.warnings.push("Too big SID for decoding, hex only")}return e+this.blockLength}toBER(t){if(this.isHexOnly){if(t)return new ArrayBuffer(this.valueHexView.byteLength);const e=this.valueHexView;const s=new Uint8Array(this.blockLength);for(let t=0;t<this.blockLength-1;t++)s[t]=e[t]|128;s[this.blockLength-1]=e[this.blockLength-1];return s.buffer}const e=w(this.valueDec,7);if(e.byteLength===0){this.error="Error during encoding SID value";return q}const s=new Uint8Array(e.byteLength);if(!t){const t=new Uint8Array(e);const r=e.byteLength-1;for(let e=0;e<r;e++)s[e]=t[e]|128;s[r]=t[r]}return s.buffer}toString(){let t="";if(this.isHexOnly)t=f.ToHex(this.valueHexView);else{t=this.valueDec.toString()}return t}toJSON(){return{...super.toJSON(),valueDec:this.valueDec}}}Vt.NAME="relativeSidBlock";class Pt extends G{constructor({value:t=M,...e}={}){super(e);this.value=[];if(t){this.fromString(t)}}fromBER(t,e,s){let r=e;while(s>0){const e=new Vt;r=e.fromBER(t,r,s);if(r===-1){this.blockLength=0;this.error=e.error;return r}this.blockLength+=e.blockLength;s-=e.blockLength;this.value.push(e)}return r}toBER(t,e){const s=[];for(let e=0;e<this.value.length;e++){const r=this.value[e].toBER(t);if(r.byteLength===0){this.error=this.value[e].error;return q}s.push(r)}return B(s)}fromString(t){this.value=[];let e=0;let s=0;let r="";do{s=t.indexOf(".",e);if(s===-1)r=t.substring(e);else r=t.substring(e,s);e=s+1;const i=new Vt;i.valueDec=parseInt(r,10);if(isNaN(i.valueDec))return true;this.value.push(i)}while(s!==-1);return true}toString(){let t="";let e=false;for(let s=0;s<this.value.length;s++){e=this.value[s].isHexOnly;let r=this.value[s].toString();if(s!==0)t=`${t}.`;if(e){r=`{${r}}`;t+=r}else t+=r}return t}toJSON(){const t={...super.toJSON(),value:this.toString(),sidArray:[]};for(let e=0;e<this.value.length;e++)t.sidArray.push(this.value[e].toJSON());return t}}Pt.NAME="RelativeObjectIdentifierValueBlock";var Mt;class qt extends Q{constructor(t={}){super(t,Pt);this.idBlock.tagClass=1;this.idBlock.tagNumber=13}getValue(){return this.valueBlock.toString()}setValue(t){this.valueBlock.fromString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.valueBlock.toString()||"empty"}`}toJSON(){return{...super.toJSON(),value:this.getValue()}}}Mt=qt;(()=>{_.RelativeObjectIdentifier=Mt})();qt.NAME="RelativeObjectIdentifier";var Lt;class Wt extends ut{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=16}}Lt=Wt;(()=>{_.Sequence=Lt})();Wt.NAME="SEQUENCE";var Ht;class Ft extends ut{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=17}}Ht=Ft;(()=>{_.Set=Ht})();Ft.NAME="SET";class Jt extends(J(G)){constructor({...t}={}){super(t);this.isHexOnly=true;this.value=M}toJSON(){return{...super.toJSON(),value:this.value}}}Jt.NAME="StringValueBlock";class zt extends Jt{}zt.NAME="SimpleStringValueBlock";class Gt extends Y{constructor({...t}={}){super(t,zt)}fromBuffer(t){this.valueBlock.value=String.fromCharCode.apply(null,h.toUint8Array(t))}fromString(t){const e=t.length;const s=this.valueBlock.valueHexView=new Uint8Array(e);for(let r=0;r<e;r++)s[r]=t.charCodeAt(r);this.valueBlock.value=t}}Gt.NAME="SIMPLE STRING";class Zt extends Gt{fromBuffer(t){this.valueBlock.valueHexView=h.toUint8Array(t);try{this.valueBlock.value=f.ToUtf8String(t)}catch(e){this.warnings.push(`Error during "decodeURIComponent": ${e}, using raw string`);this.valueBlock.value=f.ToBinary(t)}}fromString(t){this.valueBlock.valueHexView=new Uint8Array(f.FromUtf8String(t));this.valueBlock.value=t}}Zt.NAME="Utf8StringValueBlock";var Kt;class _t extends Zt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=12}}Kt=_t;(()=>{_.Utf8String=Kt})();_t.NAME="UTF8String";class Qt extends Gt{fromBuffer(t){this.valueBlock.value=f.ToUtf16String(t);this.valueBlock.valueHexView=h.toUint8Array(t)}fromString(t){this.valueBlock.value=t;this.valueBlock.valueHexView=new Uint8Array(f.FromUtf16String(t))}}Qt.NAME="BmpStringValueBlock";var Xt;class Yt extends Qt{constructor({...t}={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=30}}Xt=Yt;(()=>{_.BmpString=Xt})();Yt.NAME="BMPString";class te extends Gt{fromBuffer(t){const e=ArrayBuffer.isView(t)?t.slice().buffer:t.slice(0);const s=new Uint8Array(e);for(let t=0;t<s.length;t+=4){s[t]=s[t+3];s[t+1]=s[t+2];s[t+2]=0;s[t+3]=0}this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(e))}fromString(t){const e=t.length;const s=this.valueBlock.valueHexView=new Uint8Array(e*4);for(let r=0;r<e;r++){const e=w(t.charCodeAt(r),8);const i=new Uint8Array(e);if(i.length>4)continue;const n=4-i.length;for(let t=i.length-1;t>=0;t--)s[r*4+t+n]=i[t]}this.valueBlock.value=t}}te.NAME="UniversalStringValueBlock";var ee;class se extends te{constructor({...t}={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=28}}ee=se;(()=>{_.UniversalString=ee})();se.NAME="UniversalString";var re;class ie extends Gt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=18}}re=ie;(()=>{_.NumericString=re})();ie.NAME="NumericString";var ne;class oe extends Gt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=19}}ne=oe;(()=>{_.PrintableString=ne})();oe.NAME="PrintableString";var ce;class ae extends Gt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=20}}ce=ae;(()=>{_.TeletexString=ce})();ae.NAME="TeletexString";var ue;class le extends Gt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=21}}ue=le;(()=>{_.VideotexString=ue})();le.NAME="VideotexString";var he;class fe extends Gt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=22}}he=fe;(()=>{_.IA5String=he})();fe.NAME="IA5String";var de;class pe extends Gt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=25}}de=pe;(()=>{_.GraphicString=de})();pe.NAME="GraphicString";var ye;class ve extends Gt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=26}}ye=ve;(()=>{_.VisibleString=ye})();ve.NAME="VisibleString";var we;class ge extends Gt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=27}}we=ge;(()=>{_.GeneralString=we})();ge.NAME="GeneralString";var me;class be extends Gt{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=29}}me=be;(()=>{_.CharacterString=me})();be.NAME="CharacterString";var xe;class Se extends ve{constructor({value:t,valueDate:e,...s}={}){super(s);this.year=0;this.month=0;this.day=0;this.hour=0;this.minute=0;this.second=0;if(t){this.fromString(t);this.valueBlock.valueHexView=new Uint8Array(t.length);for(let e=0;e<t.length;e++)this.valueBlock.valueHexView[e]=t.charCodeAt(e)}if(e){this.fromDate(e);this.valueBlock.valueHexView=new Uint8Array(this.toBuffer())}this.idBlock.tagClass=1;this.idBlock.tagNumber=23}fromBuffer(t){this.fromString(String.fromCharCode.apply(null,h.toUint8Array(t)))}toBuffer(){const t=this.toString();const e=new ArrayBuffer(t.length);const s=new Uint8Array(e);for(let e=0;e<t.length;e++)s[e]=t.charCodeAt(e);return e}fromDate(t){this.year=t.getUTCFullYear();this.month=t.getUTCMonth()+1;this.day=t.getUTCDate();this.hour=t.getUTCHours();this.minute=t.getUTCMinutes();this.second=t.getUTCSeconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}fromString(t){const e=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi;const s=e.exec(t);if(s===null){this.error="Wrong input string for conversion";return}const r=parseInt(s[1],10);if(r>=50)this.year=1900+r;else this.year=2e3+r;this.month=parseInt(s[2],10);this.day=parseInt(s[3],10);this.hour=parseInt(s[4],10);this.minute=parseInt(s[5],10);this.second=parseInt(s[6],10)}toString(t="iso"){if(t==="iso"){const t=new Array(7);t[0]=S(this.year<2e3?this.year-1900:this.year-2e3,2);t[1]=S(this.month,2);t[2]=S(this.day,2);t[3]=S(this.hour,2);t[4]=S(this.minute,2);t[5]=S(this.second,2);t[6]="Z";return t.join("")}return super.toString(t)}onAsciiEncoding(){return`${this.constructor.NAME} : ${this.toDate().toISOString()}`}toJSON(){return{...super.toJSON(),year:this.year,month:this.month,day:this.day,hour:this.hour,minute:this.minute,second:this.second}}}xe=Se;(()=>{_.UTCTime=xe})();Se.NAME="UTCTime";var Ae;class Be extends Se{constructor(t={}){var e;super(t);(e=this.millisecond)!==null&&e!==void 0?e:this.millisecond=0;this.idBlock.tagClass=1;this.idBlock.tagNumber=24}fromDate(t){super.fromDate(t);this.millisecond=t.getUTCMilliseconds()}toDate(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}fromString(t){let e=false;let s="";let r="";let i=0;let n;let o=0;let c=0;if(t[t.length-1]==="Z"){s=t.substring(0,t.length-1);e=true}else{const e=new Number(t[t.length-1]);if(isNaN(e.valueOf()))throw new Error("Wrong input string for conversion");s=t}if(e){if(s.indexOf("+")!==-1)throw new Error("Wrong input string for conversion");if(s.indexOf("-")!==-1)throw new Error("Wrong input string for conversion")}else{let t=1;let e=s.indexOf("+");let r="";if(e===-1){e=s.indexOf("-");t=-1}if(e!==-1){r=s.substring(e+1);s=s.substring(0,e);if(r.length!==2&&r.length!==4)throw new Error("Wrong input string for conversion");let i=parseInt(r.substring(0,2),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");o=t*i;if(r.length===4){i=parseInt(r.substring(2,4),10);if(isNaN(i.valueOf()))throw new Error("Wrong input string for conversion");c=t*i}}}let a=s.indexOf(".");if(a===-1)a=s.indexOf(",");if(a!==-1){const t=new Number(`0${s.substring(a)}`);if(isNaN(t.valueOf()))throw new Error("Wrong input string for conversion");i=t.valueOf();r=s.substring(0,a)}else r=s;switch(true){case r.length===8:n=/(\d{4})(\d{2})(\d{2})/gi;if(a!==-1)throw new Error("Wrong input string for conversion");break;case r.length===10:n=/(\d{4})(\d{2})(\d{2})(\d{2})/gi;if(a!==-1){let t=60*i;this.minute=Math.floor(t);t=60*(t-this.minute);this.second=Math.floor(t);t=1e3*(t-this.second);this.millisecond=Math.floor(t)}break;case r.length===12:n=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi;if(a!==-1){let t=60*i;this.second=Math.floor(t);t=1e3*(t-this.second);this.millisecond=Math.floor(t)}break;case r.length===14:n=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi;if(a!==-1){const t=1e3*i;this.millisecond=Math.floor(t)}break;default:throw new Error("Wrong input string for conversion")}const u=n.exec(r);if(u===null)throw new Error("Wrong input string for conversion");for(let t=1;t<u.length;t++){switch(t){case 1:this.year=parseInt(u[t],10);break;case 2:this.month=parseInt(u[t],10);break;case 3:this.day=parseInt(u[t],10);break;case 4:this.hour=parseInt(u[t],10)+o;break;case 5:this.minute=parseInt(u[t],10)+c;break;case 6:this.second=parseInt(u[t],10);break;default:throw new Error("Wrong input string for conversion")}}if(e===false){const t=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=t.getUTCFullYear();this.month=t.getUTCMonth();this.day=t.getUTCDay();this.hour=t.getUTCHours();this.minute=t.getUTCMinutes();this.second=t.getUTCSeconds();this.millisecond=t.getUTCMilliseconds()}}toString(t="iso"){if(t==="iso"){const t=[];t.push(S(this.year,4));t.push(S(this.month,2));t.push(S(this.day,2));t.push(S(this.hour,2));t.push(S(this.minute,2));t.push(S(this.second,2));if(this.millisecond!==0){t.push(".");t.push(S(this.millisecond,3))}t.push("Z");return t.join("")}return super.toString(t)}toJSON(){return{...super.toJSON(),millisecond:this.millisecond}}}Ae=Be;(()=>{_.GeneralizedTime=Ae})();Be.NAME="GeneralizedTime";var Ee;class Oe extends _t{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=31}}Ee=Oe;(()=>{_.DATE=Ee})();Oe.NAME="DATE";var Ie;class ke extends _t{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=32}}Ie=ke;(()=>{_.TimeOfDay=Ie})();ke.NAME="TimeOfDay";var Ne;class Ue extends _t{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=33}}Ne=Ue;(()=>{_.DateTime=Ne})();Ue.NAME="DateTime";var $e;class je extends _t{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=34}}$e=je;(()=>{_.Duration=$e})();je.NAME="Duration";var Te;class Re extends _t{constructor(t={}){super(t);this.idBlock.tagClass=1;this.idBlock.tagNumber=14}}Te=Re;(()=>{_.TIME=Te})();Re.NAME="TIME";class Ce{constructor({name:t=M,optional:e=false}={}){this.name=t;this.optional=e}}class De extends Ce{constructor({value:t=[],...e}={}){super(e);this.value=t}}class Ve extends Ce{constructor({value:t=new Ce,local:e=false,...s}={}){super(s);this.value=t;this.local=e}}class Pe{constructor({data:t=L}={}){this.dataView=h.toUint8Array(t)}get data(){return this.dataView.slice().buffer}set data(t){this.dataView=h.toUint8Array(t)}fromBER(t,e,s){const r=e+s;this.dataView=h.toUint8Array(t).subarray(e,r);return r}toBER(t){return this.dataView.slice().buffer}}function Me(t,e,s){if(s instanceof De){for(let r=0;r<s.value.length;r++){const i=Me(t,e,s.value[r]);if(i.verified){return{verified:true,result:t}}}{const t={verified:false,result:{error:"Wrong values for Choice type"}};if(s.hasOwnProperty(N))t.name=s.name;return t}}if(s instanceof Ce){if(s.hasOwnProperty(N))t[s.name]=e;return{verified:true,result:t}}if(t instanceof Object===false){return{verified:false,result:{error:"Wrong root object"}}}if(e instanceof Object===false){return{verified:false,result:{error:"Wrong ASN.1 data"}}}if(s instanceof Object===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(j in s===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(D in s.idBlock===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(V in s.idBlock===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}const r=s.idBlock.toBER(false);if(r.byteLength===0){return{verified:false,result:{error:"Error encoding idBlock for ASN.1 schema"}}}const i=s.idBlock.fromBER(r,0,r.byteLength);if(i===-1){return{verified:false,result:{error:"Error decoding idBlock for ASN.1 schema"}}}if(s.idBlock.hasOwnProperty(T)===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(s.idBlock.tagClass!==e.idBlock.tagClass){return{verified:false,result:t}}if(s.idBlock.hasOwnProperty(R)===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(s.idBlock.tagNumber!==e.idBlock.tagNumber){return{verified:false,result:t}}if(s.idBlock.hasOwnProperty(C)===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(s.idBlock.isConstructed!==e.idBlock.isConstructed){return{verified:false,result:t}}if(!($ in s.idBlock)){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(s.idBlock.isHexOnly!==e.idBlock.isHexOnly){return{verified:false,result:t}}if(s.idBlock.isHexOnly){if(U in s.idBlock===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}const r=s.idBlock.valueHexView;const i=e.idBlock.valueHexView;if(r.length!==i.length){return{verified:false,result:t}}for(let e=0;e<r.length;e++){if(r[e]!==i[1]){return{verified:false,result:t}}}}if(s.name){s.name=s.name.replace(/^\s+|\s+$/g,M);if(s.name)t[s.name]=e}if(s instanceof _.Constructed){let r=0;let i={verified:false,result:{error:"Unknown error"}};let n=s.valueBlock.value.length;if(n>0){if(s.valueBlock.value[0]instanceof Ve){n=e.valueBlock.value.length}}if(n===0){return{verified:true,result:t}}if(e.valueBlock.value.length===0&&s.valueBlock.value.length!==0){let e=true;for(let t=0;t<s.valueBlock.value.length;t++)e=e&&(s.valueBlock.value[t].optional||false);if(e){return{verified:true,result:t}}if(s.name){s.name=s.name.replace(/^\s+|\s+$/g,M);if(s.name)delete t[s.name]}t.error="Inconsistent object length";return{verified:false,result:t}}for(let o=0;o<n;o++){if(o-r>=e.valueBlock.value.length){if(s.valueBlock.value[o].optional===false){const e={verified:false,result:t};t.error="Inconsistent length between ASN.1 data and schema";if(s.name){s.name=s.name.replace(/^\s+|\s+$/g,M);if(s.name){delete t[s.name];e.name=s.name}}return e}}else{if(s.valueBlock.value[0]instanceof Ve){i=Me(t,e.valueBlock.value[o],s.valueBlock.value[0].value);if(i.verified===false){if(s.valueBlock.value[0].optional)r++;else{if(s.name){s.name=s.name.replace(/^\s+|\s+$/g,M);if(s.name)delete t[s.name]}return i}}if(N in s.valueBlock.value[0]&&s.valueBlock.value[0].name.length>0){let r={};if(P in s.valueBlock.value[0]&&s.valueBlock.value[0].local)r=e;else r=t;if(typeof r[s.valueBlock.value[0].name]==="undefined")r[s.valueBlock.value[0].name]=[];r[s.valueBlock.value[0].name].push(e.valueBlock.value[o])}}else{i=Me(t,e.valueBlock.value[o-r],s.valueBlock.value[o]);if(i.verified===false){if(s.valueBlock.value[o].optional)r++;else{if(s.name){s.name=s.name.replace(/^\s+|\s+$/g,M);if(s.name)delete t[s.name]}return i}}}}}if(i.verified===false){const e={verified:false,result:t};if(s.name){s.name=s.name.replace(/^\s+|\s+$/g,M);if(s.name){delete t[s.name];e.name=s.name}}return e}return{verified:true,result:t}}if(s.primitiveSchema&&U in e.valueBlock){const r=it(e.valueBlock.valueHexView);if(r.offset===-1){const e={verified:false,result:r.result};if(s.name){s.name=s.name.replace(/^\s+|\s+$/g,M);if(s.name){delete t[s.name];e.name=s.name}}return e}return Me(t,r.result,s.primitiveSchema)}return{verified:true,result:t}}function qe(t,e){if(e instanceof Object===false){return{verified:false,result:{error:"Wrong ASN.1 schema type"}}}const s=it(h.toUint8Array(t));if(s.offset===-1){return{verified:false,result:s.result}}return Me(s.result,s.result,e)}const Le=Object.freeze({__proto__:null,Any:Ce,BaseBlock:Q,BaseStringBlock:Y,BitString:At,BmpString:Yt,Boolean:wt,CharacterString:be,Choice:De,Constructed:ut,DATE:Oe,DateTime:Ue,Duration:je,EndOfContent:ft,Enumerated:jt,GeneralString:ge,GeneralizedTime:Be,GraphicString:pe,HexBlock:J,IA5String:fe,Integer:Ut,Null:pt,NumericString:ie,ObjectIdentifier:Dt,OctetString:bt,Primitive:st,PrintableString:oe,RawData:Pe,RelativeObjectIdentifier:qt,Repeated:Ve,Sequence:Wt,Set:Ft,TIME:Re,TeletexString:ae,TimeOfDay:ke,UTCTime:Se,UniversalString:se,Utf8String:_t,ValueBlock:G,VideotexString:le,ViewWriter:O,VisibleString:ve,compareSchema:Me,fromBER:nt,verifySchema:qe});var We;(function(t){t[t["Sequence"]=0]="Sequence";t[t["Set"]=1]="Set";t[t["Choice"]=2]="Choice"})(We||(We={}));var He;(function(t){t[t["Any"]=1]="Any";t[t["Boolean"]=2]="Boolean";t[t["OctetString"]=3]="OctetString";t[t["BitString"]=4]="BitString";t[t["Integer"]=5]="Integer";t[t["Enumerated"]=6]="Enumerated";t[t["ObjectIdentifier"]=7]="ObjectIdentifier";t[t["Utf8String"]=8]="Utf8String";t[t["BmpString"]=9]="BmpString";t[t["UniversalString"]=10]="UniversalString";t[t["NumericString"]=11]="NumericString";t[t["PrintableString"]=12]="PrintableString";t[t["TeletexString"]=13]="TeletexString";t[t["VideotexString"]=14]="VideotexString";t[t["IA5String"]=15]="IA5String";t[t["GraphicString"]=16]="GraphicString";t[t["VisibleString"]=17]="VisibleString";t[t["GeneralString"]=18]="GeneralString";t[t["CharacterString"]=19]="CharacterString";t[t["UTCTime"]=20]="UTCTime";t[t["GeneralizedTime"]=21]="GeneralizedTime";t[t["DATE"]=22]="DATE";t[t["TimeOfDay"]=23]="TimeOfDay";t[t["DateTime"]=24]="DateTime";t[t["Duration"]=25]="Duration";t[t["TIME"]=26]="TIME";t[t["Null"]=27]="Null"})(He||(He={}));class Fe{constructor(t,e=0){this.unusedBits=0;this.value=new ArrayBuffer(0);if(t){if(typeof t==="number"){this.fromNumber(t)}else if(h.isBufferSource(t)){this.unusedBits=e;this.value=h.toArrayBuffer(t)}else{throw TypeError("Unsupported type of 'params' argument for BitString")}}}fromASN(t){if(!(t instanceof At)){throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString")}this.unusedBits=t.valueBlock.unusedBits;this.value=t.valueBlock.valueHex;return this}toASN(){return new At({unusedBits:this.unusedBits,valueHex:this.value})}toSchema(t){return new At({name:t})}toNumber(){let t="";const e=new Uint8Array(this.value);for(const s of e){t+=s.toString(2).padStart(8,"0")}t=t.split("").reverse().join("");if(this.unusedBits){t=t.slice(this.unusedBits).padStart(this.unusedBits,"0")}return parseInt(t,2)}fromNumber(t){let e=t.toString(2);const s=e.length+7>>3;this.unusedBits=(s<<3)-e.length;const r=new Uint8Array(s);e=e.padStart(s<<3,"0").split("").reverse().join("");let i=0;while(i<s){r[i]=parseInt(e.slice(i<<3,(i<<3)+8),2);i++}this.value=r.buffer}}class Je{get byteLength(){return this.buffer.byteLength}get byteOffset(){return 0}constructor(t){if(typeof t==="number"){this.buffer=new ArrayBuffer(t)}else{if(h.isBufferSource(t)){this.buffer=h.toArrayBuffer(t)}else if(Array.isArray(t)){this.buffer=new Uint8Array(t)}else{this.buffer=new ArrayBuffer(0)}}}fromASN(t){if(!(t instanceof bt)){throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString")}this.buffer=t.valueBlock.valueHex;return this}toASN(){return new bt({valueHex:this.buffer})}toSchema(t){return new bt({name:t})}}const ze={fromASN:t=>t instanceof pt?null:t.valueBeforeDecodeView,toASN:t=>{if(t===null){return new pt}const e=nt(t);if(e.result.error){throw new Error(e.result.error)}return e.result}};const Ge={fromASN:t=>t.valueBlock.valueHexView.byteLength>=4?t.valueBlock.toString():t.valueBlock.valueDec,toASN:t=>new Ut({value:+t})};const Ze={fromASN:t=>t.valueBlock.valueDec,toASN:t=>new jt({value:t})};const Ke={fromASN:t=>t.valueBlock.valueHexView,toASN:t=>new Ut({valueHex:t})};const _e={fromASN:t=>t.valueBlock.valueHexView,toASN:t=>new At({valueHex:t})};const Qe={fromASN:t=>t.valueBlock.toString(),toASN:t=>new Dt({value:t})};const Xe={fromASN:t=>t.valueBlock.value,toASN:t=>new wt({value:t})};const Ye={fromASN:t=>t.valueBlock.valueHexView,toASN:t=>new bt({valueHex:t})};const ts={fromASN:t=>new Je(t.getValue()),toASN:t=>t.toASN()};function es(t){return{fromASN:t=>t.valueBlock.value,toASN:e=>new t({value:e})}}const ss=es(_t);const rs=es(Yt);const is=es(se);const ns=es(ie);const os=es(oe);const cs=es(ae);const as=es(le);const us=es(fe);const ls=es(pe);const hs=es(ve);const fs=es(ge);const ds=es(be);const ps={fromASN:t=>t.toDate(),toASN:t=>new Se({valueDate:t})};const ys={fromASN:t=>t.toDate(),toASN:t=>new Be({valueDate:t})};const vs={fromASN:()=>null,toASN:()=>new pt};function ws(t){switch(t){case He.Any:return ze;case He.BitString:return _e;case He.BmpString:return rs;case He.Boolean:return Xe;case He.CharacterString:return ds;case He.Enumerated:return Ze;case He.GeneralString:return fs;case He.GeneralizedTime:return ys;case He.GraphicString:return ls;case He.IA5String:return us;case He.Integer:return Ge;case He.Null:return vs;case He.NumericString:return ns;case He.ObjectIdentifier:return Qe;case He.OctetString:return Ye;case He.PrintableString:return os;case He.TeletexString:return cs;case He.UTCTime:return ps;case He.UniversalString:return is;case He.Utf8String:return ss;case He.VideotexString:return as;case He.VisibleString:return hs;default:return null}}function gs(t){if(typeof t==="function"&&t.prototype){if(t.prototype.toASN&&t.prototype.fromASN){return true}else{return gs(t.prototype)}}else{return!!(t&&typeof t==="object"&&"toASN"in t&&"fromASN"in t)}}function ms(t){var e;if(t){const s=Object.getPrototypeOf(t);if(((e=s===null||s===void 0?void 0:s.prototype)===null||e===void 0?void 0:e.constructor)===Array){return true}return ms(s)}return false}function bs(t,e){if(!(t&&e)){return false}if(t.byteLength!==e.byteLength){return false}const s=new Uint8Array(t);const r=new Uint8Array(e);for(let e=0;e<t.byteLength;e++){if(s[e]!==r[e]){return false}}return true}class xs{constructor(){this.items=new WeakMap}has(t){return this.items.has(t)}get(t,e=false){const s=this.items.get(t);if(!s){throw new Error(`Cannot get schema for '${t.prototype.constructor.name}' target`)}if(e&&!s.schema){throw new Error(`Schema '${t.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`)}return s}cache(t){const e=this.get(t);if(!e.schema){e.schema=this.create(t,true)}}createDefault(t){const e={type:We.Sequence,items:{}};const s=this.findParentSchema(t);if(s){Object.assign(e,s);e.items=Object.assign({},e.items,s.items)}return e}create(t,e){const s=this.items.get(t)||this.createDefault(t);const r=[];for(const t in s.items){const i=s.items[t];const n=e?t:"";let o;if(typeof i.type==="number"){const t=He[i.type];const e=Le[t];if(!e){throw new Error(`Cannot get ASN1 class by name '${t}'`)}o=new e({name:n})}else if(gs(i.type)){const t=new i.type;o=t.toSchema(n)}else if(i.optional){const t=this.get(i.type);if(t.type===We.Choice){o=new Ce({name:n})}else{o=this.create(i.type,false);o.name=n}}else{o=new Ce({name:n})}const c=!!i.optional||i.defaultValue!==undefined;if(i.repeated){o.name="";const t=i.repeated==="set"?Ft:Wt;o=new t({name:"",value:[new Ve({name:n,value:o})]})}if(i.context!==null&&i.context!==undefined){if(i.implicit){if(typeof i.type==="number"||gs(i.type)){const t=i.repeated?ut:st;r.push(new t({name:n,optional:c,idBlock:{tagClass:3,tagNumber:i.context}}))}else{this.cache(i.type);const t=!!i.repeated;let e=!t?this.get(i.type,true).schema:o;e="valueBlock"in e?e.valueBlock.value:e.value;r.push(new ut({name:!t?n:"",optional:c,idBlock:{tagClass:3,tagNumber:i.context},value:e}))}}else{r.push(new ut({optional:c,idBlock:{tagClass:3,tagNumber:i.context},value:[o]}))}}else{o.optional=c;r.push(o)}}switch(s.type){case We.Sequence:return new Wt({value:r,name:""});case We.Set:return new Ft({value:r,name:""});case We.Choice:return new De({value:r,name:""});default:throw new Error(`Unsupported ASN1 type in use`)}}set(t,e){this.items.set(t,e);return this}findParentSchema(t){const e=Object.getPrototypeOf(t);if(e){const t=this.items.get(e);return t||this.findParentSchema(e)}return null}}const Ss=new xs;const As=t=>e=>{let s;if(!Ss.has(e)){s=Ss.createDefault(e);Ss.set(e,s)}else{s=Ss.get(e)}Object.assign(s,t)};const Bs=t=>(e,s)=>{let r;if(!Ss.has(e.constructor)){r=Ss.createDefault(e.constructor);Ss.set(e.constructor,r)}else{r=Ss.get(e.constructor)}const i=Object.assign({},t);if(typeof i.type==="number"&&!i.converter){const r=ws(t.type);if(!r){throw new Error(`Cannot get default converter for property '${s}' of ${e.constructor.name}`)}i.converter=r}r.items[s]=i};class Es extends Array{constructor(t=[]){if(typeof t==="number"){super(t)}else{super();for(const e of t){this.push(e)}}}}var Os=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function Is(t,e,s){return s={path:e,exports:{},require:function(t,e){return ks()}},t(s,s.exports),s.exports}function ks(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Ns=Is((function(t){(function(e){const s="(0?\\d+|0x[a-f0-9]+)";const r={fourOctet:new RegExp(`^${s}\\.${s}\\.${s}\\.${s}$`,"i"),threeOctet:new RegExp(`^${s}\\.${s}\\.${s}$`,"i"),twoOctet:new RegExp(`^${s}\\.${s}$`,"i"),longValue:new RegExp(`^${s}$`,"i")};const i=new RegExp(`^0[0-7]+$`,"i");const n=new RegExp(`^0x[a-f0-9]+$`,"i");const o="%[0-9a-z]{1,}";const c="(?:[0-9a-f]+::?)+";const a={zoneIndex:new RegExp(o,"i"),native:new RegExp(`^(::)?(${c})?([0-9a-f]+)?(::)?(${o})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${s}\\.${s}\\.${s}\\.${s}(${o})?)$`,"i"),transitional:new RegExp(`^((?:${c})|(?:::)(?:${c})?)${s}\\.${s}\\.${s}\\.${s}(${o})?$`,"i")};function u(t,e){if(t.indexOf("::")!==t.lastIndexOf("::")){return null}let s=0;let r=-1;let i=(t.match(a.zoneIndex)||[])[0];let n,o;if(i){i=i.substring(1);t=t.replace(/%.+$/,"")}while((r=t.indexOf(":",r+1))>=0){s++}if(t.substr(0,2)==="::"){s--}if(t.substr(-2,2)==="::"){s--}if(s>e){return null}o=e-s;n=":";while(o--){n+="0:"}t=t.replace("::",n);if(t[0]===":"){t=t.slice(1)}if(t[t.length-1]===":"){t=t.slice(0,-1)}e=function(){const e=t.split(":");const s=[];for(let t=0;t<e.length;t++){s.push(parseInt(e[t],16))}return s}();return{parts:e,zoneId:i}}function l(t,e,s,r){if(t.length!==e.length){throw new Error("ipaddr: cannot match CIDR for objects with different lengths")}let i=0;let n;while(r>0){n=s-r;if(n<0){n=0}if(t[i]>>n!==e[i]>>n){return false}r-=s;i+=1}return true}function h(t){if(n.test(t)){return parseInt(t,16)}if(t[0]==="0"&&!isNaN(parseInt(t[1],10))){if(i.test(t)){return parseInt(t,8)}throw new Error(`ipaddr: cannot parse ${t} as octal`)}return parseInt(t,10)}function f(t,e){while(t.length<e){t=`0${t}`}return t}const d={};d.IPv4=function(){function t(t){if(t.length!==4){throw new Error("ipaddr: ipv4 octet count should be 4")}let e,s;for(e=0;e<t.length;e++){s=t[e];if(!(0<=s&&s<=255)){throw new Error("ipaddr: ipv4 octet should fit in 8 bits")}}this.octets=t}t.prototype.SpecialRanges={unspecified:[[new t([0,0,0,0]),8]],broadcast:[[new t([255,255,255,255]),32]],multicast:[[new t([224,0,0,0]),4]],linkLocal:[[new t([169,254,0,0]),16]],loopback:[[new t([127,0,0,0]),8]],carrierGradeNat:[[new t([100,64,0,0]),10]],private:[[new t([10,0,0,0]),8],[new t([172,16,0,0]),12],[new t([192,168,0,0]),16]],reserved:[[new t([192,0,0,0]),24],[new t([192,0,2,0]),24],[new t([192,88,99,0]),24],[new t([198,18,0,0]),15],[new t([198,51,100,0]),24],[new t([203,0,113,0]),24],[new t([240,0,0,0]),4]]};t.prototype.kind=function(){return"ipv4"};t.prototype.match=function(t,e){let s;if(e===undefined){s=t;t=s[0];e=s[1]}if(t.kind()!=="ipv4"){throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one")}return l(this.octets,t.octets,8,e)};t.prototype.prefixLengthFromSubnetMask=function(){let t=0;let e=false;const s={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let r,i,n;for(r=3;r>=0;r-=1){i=this.octets[r];if(i in s){n=s[i];if(e&&n!==0){return null}if(n!==8){e=true}t+=n}else{return null}}return 32-t};t.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)};t.prototype.toByteArray=function(){return this.octets.slice(0)};t.prototype.toIPv4MappedAddress=function(){return d.IPv6.parse(`::ffff:${this.toString()}`)};t.prototype.toNormalizedString=function(){return this.toString()};t.prototype.toString=function(){return this.octets.join(".")};return t}();d.IPv4.broadcastAddressFromCIDR=function(t){try{const e=this.parseCIDR(t);const s=e[0].toByteArray();const r=this.subnetMaskFromPrefixLength(e[1]).toByteArray();const i=[];let n=0;while(n<4){i.push(parseInt(s[n],10)|parseInt(r[n],10)^255);n++}return new this(i)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}};d.IPv4.isIPv4=function(t){return this.parser(t)!==null};d.IPv4.isValid=function(t){try{new this(this.parser(t));return true}catch(t){return false}};d.IPv4.isValidFourPartDecimal=function(t){if(d.IPv4.isValid(t)&&t.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/)){return true}else{return false}};d.IPv4.networkAddressFromCIDR=function(t){let e,s,r,i,n;try{e=this.parseCIDR(t);r=e[0].toByteArray();n=this.subnetMaskFromPrefixLength(e[1]).toByteArray();i=[];s=0;while(s<4){i.push(parseInt(r[s],10)&parseInt(n[s],10));s++}return new this(i)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}};d.IPv4.parse=function(t){const e=this.parser(t);if(e===null){throw new Error("ipaddr: string is not formatted like an IPv4 Address")}return new this(e)};d.IPv4.parseCIDR=function(t){let e;if(e=t.match(/^(.+)\/(\d+)$/)){const t=parseInt(e[2]);if(t>=0&&t<=32){const s=[this.parse(e[1]),t];Object.defineProperty(s,"toString",{value:function(){return this.join("/")}});return s}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")};d.IPv4.parser=function(t){let e,s,i;if(e=t.match(r.fourOctet)){return function(){const t=e.slice(1,6);const r=[];for(let e=0;e<t.length;e++){s=t[e];r.push(h(s))}return r}()}else if(e=t.match(r.longValue)){i=h(e[1]);if(i>4294967295||i<0){throw new Error("ipaddr: address outside defined range")}return function(){const t=[];let e;for(e=0;e<=24;e+=8){t.push(i>>e&255)}return t}().reverse()}else if(e=t.match(r.twoOctet)){return function(){const t=e.slice(1,4);const s=[];i=h(t[1]);if(i>16777215||i<0){throw new Error("ipaddr: address outside defined range")}s.push(h(t[0]));s.push(i>>16&255);s.push(i>>8&255);s.push(i&255);return s}()}else if(e=t.match(r.threeOctet)){return function(){const t=e.slice(1,5);const s=[];i=h(t[2]);if(i>65535||i<0){throw new Error("ipaddr: address outside defined range")}s.push(h(t[0]));s.push(h(t[1]));s.push(i>>8&255);s.push(i&255);return s}()}else{return null}};d.IPv4.subnetMaskFromPrefixLength=function(t){t=parseInt(t);if(t<0||t>32){throw new Error("ipaddr: invalid IPv4 prefix length")}const e=[0,0,0,0];let s=0;const r=Math.floor(t/8);while(s<r){e[s]=255;s++}if(r<4){e[r]=Math.pow(2,t%8)-1<<8-t%8}return new this(e)};d.IPv6=function(){function t(t,e){let s,r;if(t.length===16){this.parts=[];for(s=0;s<=14;s+=2){this.parts.push(t[s]<<8|t[s+1])}}else if(t.length===8){this.parts=t}else{throw new Error("ipaddr: ipv6 part count should be 8 or 16")}for(s=0;s<this.parts.length;s++){r=this.parts[s];if(!(0<=r&&r<=65535)){throw new Error("ipaddr: ipv6 part should fit in 16 bits")}}if(e){this.zoneId=e}}t.prototype.SpecialRanges={unspecified:[new t([0,0,0,0,0,0,0,0]),128],linkLocal:[new t([65152,0,0,0,0,0,0,0]),10],multicast:[new t([65280,0,0,0,0,0,0,0]),8],loopback:[new t([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new t([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new t([0,0,0,0,0,65535,0,0]),96],rfc6145:[new t([0,0,0,0,65535,0,0,0]),96],rfc6052:[new t([100,65435,0,0,0,0,0,0]),96],"6to4":[new t([8194,0,0,0,0,0,0,0]),16],teredo:[new t([8193,0,0,0,0,0,0,0]),32],reserved:[[new t([8193,3512,0,0,0,0,0,0]),32]],benchmarking:[new t([8193,2,0,0,0,0,0,0]),48],amt:[new t([8193,3,0,0,0,0,0,0]),32],as112v6:[new t([8193,4,274,0,0,0,0,0]),48],deprecated:[new t([8193,16,0,0,0,0,0,0]),28],orchid2:[new t([8193,32,0,0,0,0,0,0]),28]};t.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"};t.prototype.kind=function(){return"ipv6"};t.prototype.match=function(t,e){let s;if(e===undefined){s=t;t=s[0];e=s[1]}if(t.kind()!=="ipv6"){throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one")}return l(this.parts,t.parts,16,e)};t.prototype.prefixLengthFromSubnetMask=function(){let t=0;let e=false;const s={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let r,i;for(let n=7;n>=0;n-=1){r=this.parts[n];if(r in s){i=s[r];if(e&&i!==0){return null}if(i!==16){e=true}t+=i}else{return null}}return 128-t};t.prototype.range=function(){return d.subnetMatch(this,this.SpecialRanges)};t.prototype.toByteArray=function(){let t;const e=[];const s=this.parts;for(let r=0;r<s.length;r++){t=s[r];e.push(t>>8);e.push(t&255)}return e};t.prototype.toFixedLengthString=function(){const t=function(){const t=[];for(let e=0;e<this.parts.length;e++){t.push(f(this.parts[e].toString(16),4))}return t}.call(this).join(":");let e="";if(this.zoneId){e=`%${this.zoneId}`}return t+e};t.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress()){throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4")}const t=this.parts.slice(-2);const e=t[0];const s=t[1];return new d.IPv4([e>>8,e&255,s>>8,s&255])};t.prototype.toNormalizedString=function(){const t=function(){const t=[];for(let e=0;e<this.parts.length;e++){t.push(this.parts[e].toString(16))}return t}.call(this).join(":");let e="";if(this.zoneId){e=`%${this.zoneId}`}return t+e};t.prototype.toRFC5952String=function(){const t=/((^|:)(0(:|$)){2,})/g;const e=this.toNormalizedString();let s=0;let r=-1;let i;while(i=t.exec(e)){if(i[0].length>r){s=i.index;r=i[0].length}}if(r<0){return e}return`${e.substring(0,s)}::${e.substring(s+r)}`};t.prototype.toString=function(){return this.toRFC5952String()};return t}();d.IPv6.broadcastAddressFromCIDR=function(t){try{const e=this.parseCIDR(t);const s=e[0].toByteArray();const r=this.subnetMaskFromPrefixLength(e[1]).toByteArray();const i=[];let n=0;while(n<16){i.push(parseInt(s[n],10)|parseInt(r[n],10)^255);n++}return new this(i)}catch(t){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${t})`)}};d.IPv6.isIPv6=function(t){return this.parser(t)!==null};d.IPv6.isValid=function(t){if(typeof t==="string"&&t.indexOf(":")===-1){return false}try{const e=this.parser(t);new this(e.parts,e.zoneId);return true}catch(t){return false}};d.IPv6.networkAddressFromCIDR=function(t){let e,s,r,i,n;try{e=this.parseCIDR(t);r=e[0].toByteArray();n=this.subnetMaskFromPrefixLength(e[1]).toByteArray();i=[];s=0;while(s<16){i.push(parseInt(r[s],10)&parseInt(n[s],10));s++}return new this(i)}catch(t){throw new Error(`ipaddr: the address does not have IPv6 CIDR format (${t})`)}};d.IPv6.parse=function(t){const e=this.parser(t);if(e.parts===null){throw new Error("ipaddr: string is not formatted like an IPv6 Address")}return new this(e.parts,e.zoneId)};d.IPv6.parseCIDR=function(t){let e,s,r;if(s=t.match(/^(.+)\/(\d+)$/)){e=parseInt(s[2]);if(e>=0&&e<=128){r=[this.parse(s[1]),e];Object.defineProperty(r,"toString",{value:function(){return this.join("/")}});return r}}throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")};d.IPv6.parser=function(t){let e,s,r,i,n,o;if(r=t.match(a.deprecatedTransitional)){return this.parser(`::ffff:${r[1]}`)}if(a.native.test(t)){return u(t,8)}if(r=t.match(a.transitional)){o=r[6]||"";e=u(r[1].slice(0,-1)+o,6);if(e.parts){n=[parseInt(r[2]),parseInt(r[3]),parseInt(r[4]),parseInt(r[5])];for(s=0;s<n.length;s++){i=n[s];if(!(0<=i&&i<=255)){return null}}e.parts.push(n[0]<<8|n[1]);e.parts.push(n[2]<<8|n[3]);return{parts:e.parts,zoneId:e.zoneId}}}return null};d.IPv6.subnetMaskFromPrefixLength=function(t){t=parseInt(t);if(t<0||t>128){throw new Error("ipaddr: invalid IPv6 prefix length")}const e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];let s=0;const r=Math.floor(t/8);while(s<r){e[s]=255;s++}if(r<16){e[r]=Math.pow(2,t%8)-1<<8-t%8}return new this(e)};d.fromByteArray=function(t){const e=t.length;if(e===4){return new d.IPv4(t)}else if(e===16){return new d.IPv6(t)}else{throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")}};d.isValid=function(t){return d.IPv6.isValid(t)||d.IPv4.isValid(t)};d.parse=function(t){if(d.IPv6.isValid(t)){return d.IPv6.parse(t)}else if(d.IPv4.isValid(t)){return d.IPv4.parse(t)}else{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")}};d.parseCIDR=function(t){try{return d.IPv6.parseCIDR(t)}catch(e){try{return d.IPv4.parseCIDR(t)}catch(t){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}};d.process=function(t){const e=this.parse(t);if(e.kind()==="ipv6"&&e.isIPv4MappedAddress()){return e.toIPv4Address()}else{return e}};d.subnetMatch=function(t,e,s){let r,i,n,o;if(s===undefined||s===null){s="unicast"}for(i in e){if(Object.prototype.hasOwnProperty.call(e,i)){n=e[i];if(n[0]&&!(n[0]instanceof Array)){n=[n]}for(r=0;r<n.length;r++){o=n[r];if(t.kind()===o[0].kind()&&t.match.apply(t,o)){return i}}}}return s};if(t.exports){t.exports=d}else{e.ipaddr=d}})(Os)}));class Us{static decodeIP(t){if(t.length===64&&parseInt(t,16)===0){return"::/0"}if(t.length!==16){return t}const e=parseInt(t.slice(8),16).toString(2).split("").reduce(((t,e)=>t+ +e),0);let s=t.slice(0,8).replace(/(.{2})/g,(t=>`${parseInt(t,16)}.`));s=s.slice(0,-1);return`${s}/${e}`}static toString(t){if(t.byteLength===4||t.byteLength===16){const e=new Uint8Array(t);const s=Ns.fromByteArray(Array.from(e));return s.toString()}return this.decodeIP(f.ToHex(t))}static fromString(t){const e=Ns.parse(t);return new Uint8Array(e.toByteArray()).buffer}}var $s,js,Ts;let Rs=class t{constructor(t={}){Object.assign(this,t)}toString(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""}};y([Bs({type:He.TeletexString})],Rs.prototype,"teletexString",void 0);y([Bs({type:He.PrintableString})],Rs.prototype,"printableString",void 0);y([Bs({type:He.UniversalString})],Rs.prototype,"universalString",void 0);y([Bs({type:He.Utf8String})],Rs.prototype,"utf8String",void 0);y([Bs({type:He.BmpString})],Rs.prototype,"bmpString",void 0);Rs=y([As({type:We.Choice})],Rs);let Cs=class t extends Rs{constructor(t={}){super(t);Object.assign(this,t)}toString(){return this.ia5String||(this.anyValue?f.ToHex(this.anyValue):super.toString())}};y([Bs({type:He.IA5String})],Cs.prototype,"ia5String",void 0);y([Bs({type:He.Any})],Cs.prototype,"anyValue",void 0);Cs=y([As({type:We.Choice})],Cs);class Ds{constructor(t={}){this.type="";this.value=new Cs;Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier})],Ds.prototype,"type",void 0);y([Bs({type:Cs})],Ds.prototype,"value",void 0);let Vs=$s=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,$s.prototype)}};Vs=$s=y([As({type:We.Set,itemType:Ds})],Vs);let Ps=js=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,js.prototype)}};Ps=js=y([As({type:We.Sequence,itemType:Vs})],Ps);let Ms=Ts=class t extends Ps{constructor(t){super(t);Object.setPrototypeOf(this,Ts.prototype)}};Ms=Ts=y([As({type:We.Sequence})],Ms);const qs={fromASN:t=>Us.toString(Ye.fromASN(t)),toASN:t=>Ye.toASN(Us.fromString(t))};class Ls{constructor(t={}){this.typeId="";this.value=new ArrayBuffer(0);Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier})],Ls.prototype,"typeId",void 0);y([Bs({type:He.Any,context:0})],Ls.prototype,"value",void 0);class Ws{constructor(t={}){this.partyName=new Rs;Object.assign(this,t)}}y([Bs({type:Rs,optional:true,context:0,implicit:true})],Ws.prototype,"nameAssigner",void 0);y([Bs({type:Rs,context:1,implicit:true})],Ws.prototype,"partyName",void 0);let Hs=class t{constructor(t={}){Object.assign(this,t)}};y([Bs({type:Ls,context:0,implicit:true})],Hs.prototype,"otherName",void 0);y([Bs({type:He.IA5String,context:1,implicit:true})],Hs.prototype,"rfc822Name",void 0);y([Bs({type:He.IA5String,context:2,implicit:true})],Hs.prototype,"dNSName",void 0);y([Bs({type:He.Any,context:3,implicit:true})],Hs.prototype,"x400Address",void 0);y([Bs({type:Ms,context:4,implicit:false})],Hs.prototype,"directoryName",void 0);y([Bs({type:Ws,context:5})],Hs.prototype,"ediPartyName",void 0);y([Bs({type:He.IA5String,context:6,implicit:true})],Hs.prototype,"uniformResourceIdentifier",void 0);y([Bs({type:He.OctetString,context:7,implicit:true,converter:qs})],Hs.prototype,"iPAddress",void 0);y([Bs({type:He.ObjectIdentifier,context:8,implicit:true})],Hs.prototype,"registeredID",void 0);Hs=y([As({type:We.Choice})],Hs);const Fs="1.3.6.1.5.5.7";const Js=`${Fs}.1`;const zs="2.5.29";var Gs;const Zs=`${Js}.1`;class Ks{constructor(t={}){this.accessMethod="";this.accessLocation=new Hs;Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier})],Ks.prototype,"accessMethod",void 0);y([Bs({type:Hs})],Ks.prototype,"accessLocation",void 0);let _s=Gs=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,Gs.prototype)}};_s=Gs=y([As({type:We.Sequence,itemType:Ks})],_s);const Qs=`${zs}.35`;class Xs extends Je{}class Ys{constructor(t={}){if(t){Object.assign(this,t)}}}y([Bs({type:Xs,context:0,optional:true,implicit:true})],Ys.prototype,"keyIdentifier",void 0);y([Bs({type:Hs,context:1,optional:true,implicit:true,repeated:"sequence"})],Ys.prototype,"authorityCertIssuer",void 0);y([Bs({type:He.Integer,context:2,optional:true,implicit:true,converter:Ke})],Ys.prototype,"authorityCertSerialNumber",void 0);const tr=`${zs}.19`;class er{constructor(t={}){this.cA=false;Object.assign(this,t)}}y([Bs({type:He.Boolean,defaultValue:false})],er.prototype,"cA",void 0);y([Bs({type:He.Integer,optional:true})],er.prototype,"pathLenConstraint",void 0);var sr;let rr=sr=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,sr.prototype)}};rr=sr=y([As({type:We.Sequence,itemType:Hs})],rr);var ir;const nr=`${zs}.29`;let or=ir=class t extends rr{constructor(t){super(t);Object.setPrototypeOf(this,ir.prototype)}};or=ir=y([As({type:We.Sequence})],or);var cr;const ar=`${zs}.32`;let ur=class t{constructor(t={}){Object.assign(this,t)}toString(){return this.ia5String||this.visibleString||this.bmpString||this.utf8String||""}};y([Bs({type:He.IA5String})],ur.prototype,"ia5String",void 0);y([Bs({type:He.VisibleString})],ur.prototype,"visibleString",void 0);y([Bs({type:He.BmpString})],ur.prototype,"bmpString",void 0);y([Bs({type:He.Utf8String})],ur.prototype,"utf8String",void 0);ur=y([As({type:We.Choice})],ur);class lr{constructor(t={}){this.organization=new ur;this.noticeNumbers=[];Object.assign(this,t)}}y([Bs({type:ur})],lr.prototype,"organization",void 0);y([Bs({type:He.Integer,repeated:"sequence"})],lr.prototype,"noticeNumbers",void 0);class hr{constructor(t={}){Object.assign(this,t)}}y([Bs({type:lr,optional:true})],hr.prototype,"noticeRef",void 0);y([Bs({type:ur,optional:true})],hr.prototype,"explicitText",void 0);let fr=class t{constructor(t={}){Object.assign(this,t)}};y([Bs({type:He.IA5String})],fr.prototype,"cPSuri",void 0);y([Bs({type:hr})],fr.prototype,"userNotice",void 0);fr=y([As({type:We.Choice})],fr);class dr{constructor(t={}){this.policyQualifierId="";this.qualifier=new ArrayBuffer(0);Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier})],dr.prototype,"policyQualifierId",void 0);y([Bs({type:He.Any})],dr.prototype,"qualifier",void 0);class pr{constructor(t={}){this.policyIdentifier="";Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier})],pr.prototype,"policyIdentifier",void 0);y([Bs({type:dr,repeated:"sequence",optional:true})],pr.prototype,"policyQualifiers",void 0);let yr=cr=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,cr.prototype)}};yr=cr=y([As({type:We.Sequence,itemType:pr})],yr);const vr=`${zs}.20`;let wr=class t{constructor(t=0){this.value=t}};y([Bs({type:He.Integer})],wr.prototype,"value",void 0);wr=y([As({type:We.Choice})],wr);const gr=`${zs}.27`;let mr=class t extends wr{};mr=y([As({type:We.Choice})],mr);var br;const xr=`${zs}.31`;var Sr;(function(t){t[t["unused"]=1]="unused";t[t["keyCompromise"]=2]="keyCompromise";t[t["cACompromise"]=4]="cACompromise";t[t["affiliationChanged"]=8]="affiliationChanged";t[t["superseded"]=16]="superseded";t[t["cessationOfOperation"]=32]="cessationOfOperation";t[t["certificateHold"]=64]="certificateHold";t[t["privilegeWithdrawn"]=128]="privilegeWithdrawn";t[t["aACompromise"]=256]="aACompromise"})(Sr||(Sr={}));class Ar extends Fe{toJSON(){const t=[];const e=this.toNumber();if(e&Sr.aACompromise){t.push("aACompromise")}if(e&Sr.affiliationChanged){t.push("affiliationChanged")}if(e&Sr.cACompromise){t.push("cACompromise")}if(e&Sr.certificateHold){t.push("certificateHold")}if(e&Sr.cessationOfOperation){t.push("cessationOfOperation")}if(e&Sr.keyCompromise){t.push("keyCompromise")}if(e&Sr.privilegeWithdrawn){t.push("privilegeWithdrawn")}if(e&Sr.superseded){t.push("superseded")}if(e&Sr.unused){t.push("unused")}return t}toString(){return`[${this.toJSON().join(", ")}]`}}let Br=class t{constructor(t={}){Object.assign(this,t)}};y([Bs({type:Hs,context:0,repeated:"sequence",implicit:true})],Br.prototype,"fullName",void 0);y([Bs({type:Vs,context:1,implicit:true})],Br.prototype,"nameRelativeToCRLIssuer",void 0);Br=y([As({type:We.Choice})],Br);class Er{constructor(t={}){Object.assign(this,t)}}y([Bs({type:Br,context:0,optional:true})],Er.prototype,"distributionPoint",void 0);y([Bs({type:Ar,context:1,optional:true,implicit:true})],Er.prototype,"reasons",void 0);y([Bs({type:Hs,context:2,optional:true,repeated:"sequence",implicit:true})],Er.prototype,"cRLIssuer",void 0);let Or=br=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,br.prototype)}};Or=br=y([As({type:We.Sequence,itemType:Er})],Or);var Ir;let kr=Ir=class t extends Or{constructor(t){super(t);Object.setPrototypeOf(this,Ir.prototype)}};kr=Ir=y([As({type:We.Sequence,itemType:Er})],kr);const Nr=`${zs}.28`;class Ur{constructor(t={}){this.onlyContainsUserCerts=Ur.ONLY;this.onlyContainsCACerts=Ur.ONLY;this.indirectCRL=Ur.ONLY;this.onlyContainsAttributeCerts=Ur.ONLY;Object.assign(this,t)}}Ur.ONLY=false;y([Bs({type:Br,context:0,optional:true})],Ur.prototype,"distributionPoint",void 0);y([Bs({type:He.Boolean,context:1,defaultValue:Ur.ONLY,implicit:true})],Ur.prototype,"onlyContainsUserCerts",void 0);y([Bs({type:He.Boolean,context:2,defaultValue:Ur.ONLY,implicit:true})],Ur.prototype,"onlyContainsCACerts",void 0);y([Bs({type:Ar,context:3,optional:true,implicit:true})],Ur.prototype,"onlySomeReasons",void 0);y([Bs({type:He.Boolean,context:4,defaultValue:Ur.ONLY,implicit:true})],Ur.prototype,"indirectCRL",void 0);y([Bs({type:He.Boolean,context:5,defaultValue:Ur.ONLY,implicit:true})],Ur.prototype,"onlyContainsAttributeCerts",void 0);const $r=`${zs}.21`;var jr;(function(t){t[t["unspecified"]=0]="unspecified";t[t["keyCompromise"]=1]="keyCompromise";t[t["cACompromise"]=2]="cACompromise";t[t["affiliationChanged"]=3]="affiliationChanged";t[t["superseded"]=4]="superseded";t[t["cessationOfOperation"]=5]="cessationOfOperation";t[t["certificateHold"]=6]="certificateHold";t[t["removeFromCRL"]=8]="removeFromCRL";t[t["privilegeWithdrawn"]=9]="privilegeWithdrawn";t[t["aACompromise"]=10]="aACompromise"})(jr||(jr={}));let Tr=class t{constructor(t=jr.unspecified){this.reason=jr.unspecified;this.reason=t}toJSON(){return jr[this.reason]}toString(){return this.toJSON()}};y([Bs({type:He.Enumerated})],Tr.prototype,"reason",void 0);Tr=y([As({type:We.Choice})],Tr);var Rr;const Cr=`${zs}.37`;let Dr=Rr=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,Rr.prototype)}};Dr=Rr=y([As({type:We.Sequence,itemType:He.ObjectIdentifier})],Dr);const Vr=`${zs}.54`;let Pr=class t{constructor(t=new ArrayBuffer(0)){this.value=t}};y([Bs({type:He.Integer,converter:Ke})],Pr.prototype,"value",void 0);Pr=y([As({type:We.Choice})],Pr);const Mr=`${zs}.24`;let qr=class t{constructor(t){this.value=new Date;if(t){this.value=t}}};y([Bs({type:He.GeneralizedTime})],qr.prototype,"value",void 0);qr=y([As({type:We.Choice})],qr);var Lr;const Wr=`${zs}.18`;let Hr=Lr=class t extends rr{constructor(t){super(t);Object.setPrototypeOf(this,Lr.prototype)}};Hr=Lr=y([As({type:We.Sequence})],Hr);const Fr=`${zs}.15`;var Jr;(function(t){t[t["digitalSignature"]=1]="digitalSignature";t[t["nonRepudiation"]=2]="nonRepudiation";t[t["keyEncipherment"]=4]="keyEncipherment";t[t["dataEncipherment"]=8]="dataEncipherment";t[t["keyAgreement"]=16]="keyAgreement";t[t["keyCertSign"]=32]="keyCertSign";t[t["cRLSign"]=64]="cRLSign";t[t["encipherOnly"]=128]="encipherOnly";t[t["decipherOnly"]=256]="decipherOnly"})(Jr||(Jr={}));class zr extends Fe{toJSON(){const t=this.toNumber();const e=[];if(t&Jr.cRLSign){e.push("crlSign")}if(t&Jr.dataEncipherment){e.push("dataEncipherment")}if(t&Jr.decipherOnly){e.push("decipherOnly")}if(t&Jr.digitalSignature){e.push("digitalSignature")}if(t&Jr.encipherOnly){e.push("encipherOnly")}if(t&Jr.keyAgreement){e.push("keyAgreement")}if(t&Jr.keyCertSign){e.push("keyCertSign")}if(t&Jr.keyEncipherment){e.push("keyEncipherment")}if(t&Jr.nonRepudiation){e.push("nonRepudiation")}return e}toString(){return`[${this.toJSON().join(", ")}]`}}var Gr;const Zr=`${zs}.30`;class Kr{constructor(t={}){this.base=new Hs;this.minimum=0;Object.assign(this,t)}}y([Bs({type:Hs})],Kr.prototype,"base",void 0);y([Bs({type:He.Integer,context:0,defaultValue:0,implicit:true})],Kr.prototype,"minimum",void 0);y([Bs({type:He.Integer,context:1,optional:true,implicit:true})],Kr.prototype,"maximum",void 0);let _r=Gr=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,Gr.prototype)}};_r=Gr=y([As({type:We.Sequence,itemType:Kr})],_r);class Qr{constructor(t={}){Object.assign(this,t)}}y([Bs({type:_r,context:0,optional:true,implicit:true})],Qr.prototype,"permittedSubtrees",void 0);y([Bs({type:_r,context:1,optional:true,implicit:true})],Qr.prototype,"excludedSubtrees",void 0);const Xr=`${zs}.36`;class Yr{constructor(t={}){Object.assign(this,t)}}y([Bs({type:He.Integer,context:0,implicit:true,optional:true,converter:Ke})],Yr.prototype,"requireExplicitPolicy",void 0);y([Bs({type:He.Integer,context:1,implicit:true,optional:true,converter:Ke})],Yr.prototype,"inhibitPolicyMapping",void 0);var ti;const ei=`${zs}.33`;class si{constructor(t={}){this.issuerDomainPolicy="";this.subjectDomainPolicy="";Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier})],si.prototype,"issuerDomainPolicy",void 0);y([Bs({type:He.ObjectIdentifier})],si.prototype,"subjectDomainPolicy",void 0);let ri=ti=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,ti.prototype)}};ri=ti=y([As({type:We.Sequence,itemType:si})],ri);var ii;const ni=`${zs}.17`;let oi=ii=class t extends rr{constructor(t){super(t);Object.setPrototypeOf(this,ii.prototype)}};oi=ii=y([As({type:We.Sequence})],oi);class ci{constructor(t={}){this.type="";this.values=[];Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier})],ci.prototype,"type",void 0);y([Bs({type:He.Any,repeated:"set"})],ci.prototype,"values",void 0);var ai;const ui=`${zs}.9`;let li=ai=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,ai.prototype)}};li=ai=y([As({type:We.Sequence,itemType:ci})],li);const hi=`${zs}.14`;class fi extends Xs{}const di=`${zs}.16`;class pi{constructor(t={}){Object.assign(this,t)}}y([Bs({type:He.GeneralizedTime,context:0,implicit:true,optional:true})],pi.prototype,"notBefore",void 0);y([Bs({type:He.GeneralizedTime,context:1,implicit:true,optional:true})],pi.prototype,"notAfter",void 0);const yi="1.2.840.113533.7.65.0";var vi;(function(t){t[t["keyUpdateAllowed"]=1]="keyUpdateAllowed";t[t["newExtensions"]=2]="newExtensions";t[t["pKIXCertificate"]=4]="pKIXCertificate"})(vi||(vi={}));class wi extends Fe{toJSON(){const t=[];const e=this.toNumber();if(e&vi.pKIXCertificate){t.push("pKIXCertificate")}if(e&vi.newExtensions){t.push("newExtensions")}if(e&vi.keyUpdateAllowed){t.push("keyUpdateAllowed")}return t}toString(){return`[${this.toJSON().join(", ")}]`}}class gi{constructor(t={}){this.entrustVers="";this.entrustInfoFlags=new wi;Object.assign(this,t)}}y([Bs({type:He.GeneralString})],gi.prototype,"entrustVers",void 0);y([Bs({type:wi})],gi.prototype,"entrustInfoFlags",void 0);var mi;const bi=`${Js}.11`;let xi=mi=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,mi.prototype)}};xi=mi=y([As({type:We.Sequence,itemType:Ks})],xi);class Si{constructor(t={}){this.algorithm="";Object.assign(this,t)}isEqual(t){return t instanceof Si&&t.algorithm==this.algorithm&&(t.parameters&&this.parameters&&d(t.parameters,this.parameters)||t.parameters===this.parameters)}}y([Bs({type:He.ObjectIdentifier})],Si.prototype,"algorithm",void 0);y([Bs({type:He.Any,optional:true})],Si.prototype,"parameters",void 0);class Ai{constructor(t={}){this.algorithm=new Si;this.subjectPublicKey=new ArrayBuffer(0);Object.assign(this,t)}}y([Bs({type:Si})],Ai.prototype,"algorithm",void 0);y([Bs({type:He.BitString})],Ai.prototype,"subjectPublicKey",void 0);let Bi=class t{constructor(t){if(t){if(typeof t==="string"||typeof t==="number"||t instanceof Date){const e=new Date(t);if(e.getUTCFullYear()>2049){this.generalTime=e}else{this.utcTime=e}}else{Object.assign(this,t)}}}getTime(){const t=this.utcTime||this.generalTime;if(!t){throw new Error("Cannot get time from CHOICE object")}return t}};y([Bs({type:He.UTCTime})],Bi.prototype,"utcTime",void 0);y([Bs({type:He.GeneralizedTime})],Bi.prototype,"generalTime",void 0);Bi=y([As({type:We.Choice})],Bi);class Ei{constructor(t){this.notBefore=new Bi(new Date);this.notAfter=new Bi(new Date);if(t){this.notBefore=new Bi(t.notBefore);this.notAfter=new Bi(t.notAfter)}}}y([Bs({type:Bi})],Ei.prototype,"notBefore",void 0);y([Bs({type:Bi})],Ei.prototype,"notAfter",void 0);var Oi;class Ii{constructor(t={}){this.extnID="";this.critical=Ii.CRITICAL;this.extnValue=new Je;Object.assign(this,t)}}Ii.CRITICAL=false;y([Bs({type:He.ObjectIdentifier})],Ii.prototype,"extnID",void 0);y([Bs({type:He.Boolean,defaultValue:Ii.CRITICAL})],Ii.prototype,"critical",void 0);y([Bs({type:Je})],Ii.prototype,"extnValue",void 0);let ki=Oi=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,Oi.prototype)}};ki=Oi=y([As({type:We.Sequence,itemType:Ii})],ki);var Ni;(function(t){t[t["v1"]=0]="v1";t[t["v2"]=1]="v2";t[t["v3"]=2]="v3"})(Ni||(Ni={}));class Ui{constructor(t={}){this.version=Ni.v1;this.serialNumber=new ArrayBuffer(0);this.signature=new Si;this.issuer=new Ms;this.validity=new Ei;this.subject=new Ms;this.subjectPublicKeyInfo=new Ai;Object.assign(this,t)}}y([Bs({type:He.Integer,context:0,defaultValue:Ni.v1})],Ui.prototype,"version",void 0);y([Bs({type:He.Integer,converter:Ke})],Ui.prototype,"serialNumber",void 0);y([Bs({type:Si})],Ui.prototype,"signature",void 0);y([Bs({type:Ms})],Ui.prototype,"issuer",void 0);y([Bs({type:Ei})],Ui.prototype,"validity",void 0);y([Bs({type:Ms})],Ui.prototype,"subject",void 0);y([Bs({type:Ai})],Ui.prototype,"subjectPublicKeyInfo",void 0);y([Bs({type:He.BitString,context:1,implicit:true,optional:true})],Ui.prototype,"issuerUniqueID",void 0);y([Bs({type:He.BitString,context:2,implicit:true,optional:true})],Ui.prototype,"subjectUniqueID",void 0);y([Bs({type:ki,context:3,optional:true})],Ui.prototype,"extensions",void 0);class $i{constructor(t={}){this.tbsCertificate=new Ui;this.signatureAlgorithm=new Si;this.signatureValue=new ArrayBuffer(0);Object.assign(this,t)}}y([Bs({type:Ui})],$i.prototype,"tbsCertificate",void 0);y([Bs({type:Si})],$i.prototype,"signatureAlgorithm",void 0);y([Bs({type:He.BitString})],$i.prototype,"signatureValue",void 0);class ji{constructor(t={}){this.userCertificate=new ArrayBuffer(0);this.revocationDate=new Bi;Object.assign(this,t)}}y([Bs({type:He.Integer,converter:Ke})],ji.prototype,"userCertificate",void 0);y([Bs({type:Bi})],ji.prototype,"revocationDate",void 0);y([Bs({type:Ii,optional:true,repeated:"sequence"})],ji.prototype,"crlEntryExtensions",void 0);class Ti{constructor(t={}){this.signature=new Si;this.issuer=new Ms;this.thisUpdate=new Bi;Object.assign(this,t)}}y([Bs({type:He.Integer,optional:true})],Ti.prototype,"version",void 0);y([Bs({type:Si})],Ti.prototype,"signature",void 0);y([Bs({type:Ms})],Ti.prototype,"issuer",void 0);y([Bs({type:Bi})],Ti.prototype,"thisUpdate",void 0);y([Bs({type:Bi,optional:true})],Ti.prototype,"nextUpdate",void 0);y([Bs({type:ji,repeated:"sequence",optional:true})],Ti.prototype,"revokedCertificates",void 0);y([Bs({type:Ii,optional:true,context:0,repeated:"sequence"})],Ti.prototype,"crlExtensions",void 0);class Ri{constructor(t={}){this.tbsCertList=new Ti;this.signatureAlgorithm=new Si;this.signature=new ArrayBuffer(0);Object.assign(this,t)}}y([Bs({type:Ti})],Ri.prototype,"tbsCertList",void 0);y([Bs({type:Si})],Ri.prototype,"signatureAlgorithm",void 0);y([Bs({type:He.BitString})],Ri.prototype,"signature",void 0);var Ci;const Di=`${Js}.2`;var Vi;(function(t){t[t["picture"]=0]="picture";t[t["handwrittenSignature"]=1]="handwrittenSignature"})(Vi||(Vi={}));let Pi=class t{constructor(t={}){Object.assign(this,t)}};y([Bs({type:He.Integer})],Pi.prototype,"predefinedBiometricType",void 0);y([Bs({type:He.ObjectIdentifier})],Pi.prototype,"biometricDataOid",void 0);Pi=y([As({type:We.Choice})],Pi);class Mi{constructor(t={}){this.typeOfBiometricData=new Pi;this.hashAlgorithm=new Si;this.biometricDataHash=new Je;Object.assign(this,t)}}y([Bs({type:Pi})],Mi.prototype,"typeOfBiometricData",void 0);y([Bs({type:Si})],Mi.prototype,"hashAlgorithm",void 0);y([Bs({type:Je})],Mi.prototype,"biometricDataHash",void 0);y([Bs({type:He.IA5String,optional:true})],Mi.prototype,"sourceDataUri",void 0);let qi=Ci=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,Ci.prototype)}};qi=Ci=y([As({type:We.Sequence,itemType:Mi})],qi);const Li=`${Fs}.11`;var Wi,Hi;const Fi=`${Js}.3`;class Ji{constructor(){this.statementId="";this.statementInfo=new ArrayBuffer(0)}}y([Bs({type:He.ObjectIdentifier})],Ji.prototype,"statementId",void 0);y([Bs({type:He.Any,optional:true})],Ji.prototype,"statementInfo",void 0);const zi=`${Li}.2`;let Gi=Wi=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,Wi.prototype)}};Gi=Wi=y([As({type:We.Sequence,itemType:Hs})],Gi);class Zi{constructor(t={}){Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier,optional:true})],Zi.prototype,"semanticsIdentifier",void 0);y([Bs({type:Gi,optional:true})],Zi.prototype,"nameRegistrationAuthorities",void 0);let Ki=Hi=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,Hi.prototype)}};Ki=Hi=y([As({type:We.Sequence,itemType:Ji})],Ki);let _i=class t extends Rs{};_i=y([As({type:We.Choice})],_i);var Qi;(function(t){t["M"]="M";t["F"]="F";t["m"]="m";t["f"]="f"})(Qi||(Qi={}));var Xi;let Yi=Xi=class t extends yr{constructor(t){super(t);Object.setPrototypeOf(this,Xi.prototype)}};Yi=Xi=y([As({type:We.Sequence})],Yi);const tn="1.3.6.1.4.1.311.21.7";class en{constructor(t={}){this.templateID="";this.templateMajorVersion=0;this.templateMinorVersion=0;Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier})],en.prototype,"templateID",void 0);y([Bs({type:He.Integer})],en.prototype,"templateMajorVersion",void 0);y([Bs({type:He.Integer})],en.prototype,"templateMinorVersion",void 0);const sn="1.3.6.1.4.1.311.20.2";class rn{constructor(t={}){this.name="";Object.assign(this,t)}}y([Bs({type:He.Utf8String})],rn.prototype,"name",void 0);let nn=class t{constructor(t={}){Object.assign(this,t)}toString(){var t,e;return((t=this.name)===null||t===void 0?void 0:t.toString())||((e=this.spec)===null||e===void 0?void 0:e.name)||""}};y([Bs({type:Rs})],nn.prototype,"name",void 0);y([Bs({type:rn})],nn.prototype,"spec",void 0);nn=y([As({type:We.Choice})],nn);const on="1.3.6.1.4.1.311.21.1";let cn=class t{constructor(){this.value=new ArrayBuffer(0)}toString(){const t=this.getVersion();return`V${t.certificateIndex}.${t.keyIndex}`}getVersion(){let t=new Uint8Array(this.value);if(this.value.byteLength<4){t=new Uint8Array(4);t.set(new Uint8Array(this.value),4-this.value.byteLength)}return{keyIndex:parseInt(f.ToHex(t.slice(0,2)),16),certificateIndex:parseInt(f.ToHex(t.slice(2)),16)}}};y([Bs({type:He.Integer,converter:Ke})],cn.prototype,"value",void 0);cn=y([As({type:We.Choice})],cn);let an=class t{constructor(t={}){Object.assign(this,t)}};y([Bs({type:He.NumericString})],an.prototype,"numericString",void 0);y([Bs({type:He.PrintableString})],an.prototype,"printableString",void 0);y([Bs({type:He.TeletexString})],an.prototype,"teletexString",void 0);y([Bs({type:He.VideotexString})],an.prototype,"videotexString",void 0);y([Bs({type:He.IA5String})],an.prototype,"ia5String",void 0);y([Bs({type:He.GraphicString})],an.prototype,"graphicString",void 0);y([Bs({type:He.VisibleString})],an.prototype,"visibleString",void 0);y([Bs({type:He.GeneralString})],an.prototype,"generalString",void 0);y([Bs({type:He.UniversalString})],an.prototype,"universalString",void 0);y([Bs({type:He.BmpString})],an.prototype,"bmpString",void 0);an=y([As({type:We.Choice})],an);let un=class t{constructor(t=new ArrayBuffer(0)){this.value=t}};y([Bs({type:He.Any})],un.prototype,"value",void 0);un=y([As({type:We.Choice})],un);var ln;let hn=ln=class t extends ki{constructor(t){super(t);Object.setPrototypeOf(this,ln.prototype)}};hn=ln=y([As({type:We.Sequence})],hn);class fn{constructor(t={}){this.keySpec=0;this.cspName="";this.signature=new ArrayBuffer(0);Object.assign(this,t)}}y([Bs({type:He.Integer})],fn.prototype,"keySpec",void 0);y([Bs({type:He.BmpString})],fn.prototype,"cspName",void 0);y([Bs({type:He.BitString})],fn.prototype,"signature",void 0);var dn;let pn=dn=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,dn.prototype)}};pn=dn=y([As({type:We.Sequence,itemType:He.Any})],pn);var yn;let vn=yn=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,yn.prototype)}};vn=yn=y([As({type:We.Sequence,itemType:He.Any})],vn);var wn;class gn{constructor(t={}){this.name="";this.value="";Object.assign(this,t)}}y([Bs({type:He.BmpString})],gn.prototype,"name",void 0);y([Bs({type:He.BmpString})],gn.prototype,"value",void 0);let mn=wn=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,wn.prototype)}};mn=wn=y([As({type:We.Sequence,itemType:gn})],mn);let bn=class t extends Ls{};bn=y([As({type:We.Sequence})],bn);let xn=class t extends Ls{};xn=y([As({type:We.Sequence})],xn);let Sn=class t extends $i{};Sn=y([As({type:We.Sequence})],Sn);class An{constructor(t={}){this.clientId=0;this.machineName="";this.userName="";this.processName="";Object.assign(this,t)}}y([Bs({type:He.Integer})],An.prototype,"clientId",void 0);y([Bs({type:He.Utf8String})],An.prototype,"machineName",void 0);y([Bs({type:He.Utf8String})],An.prototype,"userName",void 0);y([Bs({type:He.Utf8String})],An.prototype,"processName",void 0);const Bn="2.16.840.1.113730";const En=`${Bn}.1`;let On=class t{constructor(t){this.value="";if(t){this.value=t}}};y([Bs({type:He.IA5String})],On.prototype,"value",void 0);On=y([As({type:We.Choice})],On);let In=class t{constructor(t){this.value="";if(t){this.value=t}}};y([Bs({type:He.IA5String})],In.prototype,"value",void 0);In=y([As({type:We.Choice})],In);let kn=class t{constructor(t){this.value="";if(t){this.value=t}}};y([Bs({type:He.IA5String})],kn.prototype,"value",void 0);kn=y([As({type:We.Choice})],kn);let Nn=class t{constructor(t){this.value="";if(t){this.value=t}}};y([Bs({type:He.IA5String})],Nn.prototype,"value",void 0);Nn=y([As({type:We.Choice})],Nn);const Un=`${En}.1`;var $n;(function(t){t[t["sslClient"]=1]="sslClient";t[t["sslServer"]=2]="sslServer";t[t["sMime"]=4]="sMime";t[t["objectSigning"]=8]="objectSigning";t[t["sslCa"]=32]="sslCa";t[t["sMimeCa"]=64]="sMimeCa";t[t["objectSigningCa"]=128]="objectSigningCa"})($n||($n={}));class jn extends Fe{toJSON(){const t=this.toNumber();const e=[];if(t&$n.objectSigning){e.push("objectSigning")}if(t&$n.objectSigningCa){e.push("objectSigningCa")}if(t&$n.sMime){e.push("sMime")}if(t&$n.sMimeCa){e.push("sMimeCa")}if(t&$n.sslCa){e.push("sslCa")}if(t&$n.sslClient){e.push("sslClient")}if(t&$n.sslServer){e.push("sslServer")}return e}toString(){return`[${this.toJSON().join(", ")}]`}}const Tn=`${En}.13`;let Rn=class t{constructor(t){this.value="";if(t){this.value=t}}};y([Bs({type:He.IA5String})],Rn.prototype,"value",void 0);Rn=y([As({type:We.Choice})],Rn);let Cn=class t{constructor(t){this.value="";if(t){this.value=t}}};y([Bs({type:He.IA5String})],Cn.prototype,"value",void 0);Cn=y([As({type:We.Choice})],Cn);let Dn=class t{constructor(t){this.value="";if(t){this.value=t}}};y([Bs({type:He.IA5String})],Dn.prototype,"value",void 0);Dn=y([As({type:We.Choice})],Dn);const Vn="1.3.6.1.4.1.52266.1";let Pn=class t{constructor(t={}){this.leiCode="";Object.assign(this,t)}};y([Bs({type:oe})],Pn.prototype,"leiCode",void 0);y([Bs({type:oe,context:0,optional:true})],Pn.prototype,"leiRole",void 0);Pn=y([As({type:We.Sequence})],Pn);let Mn=class t{get text(){if(this.bmpString!==undefined){return this.bmpString}if(this.ia5String!==undefined){return this.ia5String}if(this.printableString!==undefined){return this.printableString}if(this.utf8String!==undefined){return this.utf8String}if(this.visibleString!==undefined){return this.visibleString}return undefined}set text(t){this.printableString=t}constructor(t){if(t){this.text=t}}};y([Bs({type:He.IA5String})],Mn.prototype,"ia5String",void 0);y([Bs({type:He.VisibleString})],Mn.prototype,"visibleString",void 0);y([Bs({type:He.BmpString})],Mn.prototype,"bmpString",void 0);y([Bs({type:He.Utf8String})],Mn.prototype,"utf8String",void 0);y([Bs({type:He.PrintableString})],Mn.prototype,"printableString",void 0);Mn=y([As({type:We.Choice})],Mn);let qn=class t extends Mn{constructor(t){super();if(typeof t==="string"){this.text=t}else if(t instanceof Pn){this.struct=t}}};y([Bs({type:Pn})],qn.prototype,"struct",void 0);qn=y([As({type:We.Choice})],qn);const Ln="1.3.6.1.4.1.52266.2";let Wn=class t extends Mn{};Wn=y([As({type:We.Choice})],Wn);class Hn{get position(){return this.offset}constructor(t){this.offset=0;this.view=h.toUint8Array(t)}read(t=1){const e=this.view.slice(this.offset,this.offset+t);this.offset=this.offset+e.length;return e}readByte(){const t=this.read();if(!t.length){throw new Error("End of stream")}return t[0]}readNumber(t){const e=this.read(t);const s=f.ToHex(e);return parseInt(s,16)}readEnd(){return this.read(this.view.length-this.offset)}reset(){this.offset=0}}class Fn{static createStream(t){const e=h.toUint8Array(t);return new Hn(e)}}var Jn;(function(t){t[t["certificateTimestamp"]=0]="certificateTimestamp";t[t["treeHash"]=1]="treeHash"})(Jn||(Jn={}));var zn;(function(t){t[t["none"]=0]="none";t[t["md5"]=1]="md5";t[t["sha1"]=2]="sha1";t[t["sha224"]=3]="sha224";t[t["sha256"]=4]="sha256";t[t["sha384"]=5]="sha384";t[t["sha512"]=6]="sha512"})(zn||(zn={}));var Gn;(function(t){t[t["anonymous"]=0]="anonymous";t[t["rsa"]=1]="rsa";t[t["dsa"]=2]="dsa";t[t["ecdsa"]=3]="ecdsa"})(Gn||(Gn={}));class Zn extends Fn{constructor(t){super();this.version=0;this.logId=new ArrayBuffer(32);this.timestamp=new Date;this.extensions=new ArrayBuffer(0);this.hashAlgorithm=0;this.signatureAlgorithm=0;this.signature=new ArrayBuffer(0);if(t){this.parse(t)}}parse(t){this.version=t.readByte();t.read(2);this.logId=h.toArrayBuffer(t.read(32));this.timestamp=new Date(t.readNumber(8));const e=t.readNumber(2);this.extensions=t.read(e).buffer;this.hashAlgorithm=t.readByte();this.signatureAlgorithm=t.readByte();this.signature=t.read(t.readNumber(2)).buffer}toJSON(){return{version:this.version,logId:f.ToHex(this.logId),timestamp:this.timestamp,extensions:f.ToBase64(this.extensions),hashAlgorithm:zn[this.hashAlgorithm]||"undefined",signatureAlgorithm:Gn[this.signatureAlgorithm]||"undefined",signature:f.ToBase64(this.signature)}}}const Kn="1.3.6.1.4.1.11129.2.4.2";class _n extends Je{constructor(){super(...arguments);this.items=[]}fromASN(t){super.fromASN(t);const e=new Hn(this.buffer);const s=e.readNumber(2);this.items=[];while(e.position<s){this.items.push(new Zn(e))}return this}toJSON(){return this.items.map((t=>t.toJSON()))}}var Qn;(function(t){t[t["v1"]=1]="v1"})(Qn||(Qn={}));const Xn="1.2.840.113583.1.1.9.2";class Yn{constructor(t={}){this.version=Qn.v1;Object.assign(this,t)}}y([Bs({type:He.Integer})],Yn.prototype,"version",void 0);const to="1.2.840.113583.1.1.9.1";class eo{constructor(t={}){this.version=Qn.v1;this.location=new Hs;this.requiresAuth=false;Object.assign(this,t)}}y([Bs({type:He.Integer})],eo.prototype,"version",void 0);y([Bs({type:Hs})],eo.prototype,"location",void 0);y([Bs({type:He.Boolean,defaultValue:false,optional:true})],eo.prototype,"requiresAuth",void 0);class so{constructor(t={}){this.hashAlg=new Si;this.hashValue=new Je;Object.assign(this,t)}}y([Bs({type:Si})],so.prototype,"hashAlg",void 0);y([Bs({type:Je})],so.prototype,"hashValue",void 0);class ro{constructor(t={}){this.mediaType="";this.logotypeHash=[];this.logotypeURI=[];Object.assign(this,t)}}y([Bs({type:He.IA5String})],ro.prototype,"mediaType",void 0);y([Bs({type:so,repeated:"sequence"})],ro.prototype,"logotypeHash",void 0);y([Bs({type:He.IA5String,repeated:"sequence"})],ro.prototype,"logotypeURI",void 0);var io;(function(t){t[t["mono"]=1]="mono";t[t["stereo"]=2]="stereo";t[t["quad"]=4]="quad"})(io||(io={}));class no{constructor(t={}){this.fileSize=0;this.playTime=0;this.channels=io.mono;Object.assign(this,t)}}y([Bs({type:He.Integer})],no.prototype,"fileSize",void 0);y([Bs({type:He.Integer})],no.prototype,"playTime",void 0);y([Bs({type:He.Integer})],no.prototype,"channels",void 0);y([Bs({type:He.Integer,implicit:true,context:3,optional:true})],no.prototype,"sampleRate",void 0);y([Bs({type:He.IA5String,implicit:true,context:4,optional:true})],no.prototype,"language",void 0);class oo{constructor(t={}){this.audioDetails=new ro;Object.assign(this,t)}}y([Bs({type:ro})],oo.prototype,"audioDetails",void 0);y([Bs({type:no,optional:true})],oo.prototype,"audioInfo",void 0);let co=class t{constructor(t={}){Object.assign(this,t)}};y([Bs({type:He.Integer,context:1,implicit:true})],co.prototype,"numBits",void 0);y([Bs({type:He.Integer,context:2,implicit:true})],co.prototype,"tableSize",void 0);co=y([As({type:We.Choice})],co);var ao;(function(t){t[t["grayScale"]=0]="grayScale";t[t["color"]=1]="color"})(ao||(ao={}));class uo{constructor(t={}){this.type=ao.color;this.fileSize=0;this.xSize=0;this.ySize=0;Object.assign(this,t)}}y([Bs({type:He.Integer,context:0,implicit:true,defaultValue:ao.color})],uo.prototype,"type",void 0);y([Bs({type:He.Integer})],uo.prototype,"fileSize",void 0);y([Bs({type:He.Integer})],uo.prototype,"xSize",void 0);y([Bs({type:He.Integer})],uo.prototype,"ySize",void 0);y([Bs({type:co})],uo.prototype,"resolution",void 0);y([Bs({type:He.IA5String,context:4,implicit:true,optional:true})],uo.prototype,"language",void 0);class lo{constructor(t={}){this.imageDetails=new ro;Object.assign(this,t)}}y([Bs({type:ro})],lo.prototype,"imageDetails",void 0);y([Bs({type:uo,optional:true})],lo.prototype,"imageInfo",void 0);class ho{constructor(t={}){Object.assign(this,t)}}y([Bs({type:lo,repeated:"sequence",optional:true})],ho.prototype,"image",void 0);y([Bs({type:oo,repeated:"sequence",context:1,optional:true})],ho.prototype,"audio",void 0);class fo{constructor(t={}){this.refStructHash=[];this.refStructURI=[];Object.assign(this,t)}}y([Bs({type:so,repeated:"sequence"})],fo.prototype,"refStructHash",void 0);y([Bs({type:He.IA5String,repeated:"sequence"})],fo.prototype,"refStructURI",void 0);let po=class t{constructor(t={}){Object.assign(this,t)}};y([Bs({type:ho,implicit:true,context:0})],po.prototype,"direct",void 0);y([Bs({type:fo,implicit:true,context:1})],po.prototype,"indirect",void 0);po=y([As({type:We.Choice})],po);class yo{constructor(t={}){this.logotypeType="";this.info=new po;Object.assign(this,t)}}y([Bs({type:He.ObjectIdentifier})],yo.prototype,"logotypeType",void 0);y([Bs({type:po})],yo.prototype,"info",void 0);class vo{constructor(t={}){Object.assign(this,t)}}y([Bs({type:po,context:0,repeated:"sequence",optional:true})],vo.prototype,"communityLogos",void 0);y([Bs({type:po,context:1,optional:true})],vo.prototype,"issuerLogo",void 0);y([Bs({type:po,context:2,optional:true})],vo.prototype,"subjectLogo",void 0);y([Bs({type:yo,context:3,repeated:"sequence",optional:true})],vo.prototype,"otherLogos",void 0);var wo,go,mo;const bo="1.3.6.1.5.5.7";const xo=`${bo}.1`;let So=wo=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,wo.prototype)}};So=wo=y([As({type:We.Sequence,itemType:He.IA5String})],So);class Ao{constructor(t={}){this.claim="";this.permitted=[];Object.assign(this,t)}}y([Bs({type:He.IA5String})],Ao.prototype,"claim",void 0);y([Bs({type:He.Utf8String,repeated:"sequence"})],Ao.prototype,"permitted",void 0);let Bo=go=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,go.prototype)}};Bo=go=y([As({type:We.Sequence,itemType:Ao})],Bo);class Eo{constructor(t={}){Object.assign(this,t)}}y([Bs({type:So,optional:true,context:0})],Eo.prototype,"mustInclude",void 0);y([Bs({type:Bo,optional:true,context:1})],Eo.prototype,"permittedValues",void 0);const Oo=`${xo}.26`;class Io{constructor(){this.start="";this.count=2}}y([Bs({type:He.IA5String})],Io.prototype,"start",void 0);y([Bs({type:He.Integer})],Io.prototype,"count",void 0);let ko=class t{constructor(t={}){Object.assign(this,t)}};y([Bs({type:He.IA5String,context:0})],ko.prototype,"spc",void 0);y([Bs({type:Io,context:1})],ko.prototype,"range",void 0);y([Bs({type:He.IA5String,context:2})],ko.prototype,"one",void 0);ko=y([As({type:We.Choice})],ko);let No=mo=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,mo.prototype)}};No=mo=y([As({type:We.Sequence,itemType:ko})],No);var Uo;const $o="1.3.6.1.4.1.11129.2.1.17";var jo;(function(t){t[t["verified"]=0]="verified";t[t["selfSigned"]=1]="selfSigned";t[t["unverified"]=2]="unverified";t[t["failed"]=3]="failed"})(jo||(jo={}));class To{constructor(t={}){this.verifiedBootKey=new Je;this.deviceLocked=false;this.verifiedBootState=jo.verified;Object.assign(this,t)}}y([Bs({type:Je})],To.prototype,"verifiedBootKey",void 0);y([Bs({type:He.Boolean})],To.prototype,"deviceLocked",void 0);y([Bs({type:He.Enumerated})],To.prototype,"verifiedBootState",void 0);y([Bs({type:Je,optional:true})],To.prototype,"verifiedBootHash",void 0);let Ro=Uo=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,Uo.prototype)}};Ro=Uo=y([As({type:We.Set,itemType:He.Integer})],Ro);class Co{constructor(t={}){Object.assign(this,t)}}y([Bs({context:1,type:Ro,optional:true})],Co.prototype,"purpose",void 0);y([Bs({context:2,type:He.Integer,optional:true})],Co.prototype,"algorithm",void 0);y([Bs({context:3,type:He.Integer,optional:true})],Co.prototype,"keySize",void 0);y([Bs({context:5,type:Ro,optional:true})],Co.prototype,"digest",void 0);y([Bs({context:6,type:Ro,optional:true})],Co.prototype,"padding",void 0);y([Bs({context:10,type:He.Integer,optional:true})],Co.prototype,"ecCurve",void 0);y([Bs({context:200,type:He.Integer,optional:true})],Co.prototype,"rsaPublicExponent",void 0);y([Bs({context:203,type:Ro,optional:true})],Co.prototype,"mgfDigest",void 0);y([Bs({context:303,type:He.Null,optional:true})],Co.prototype,"rollbackResistance",void 0);y([Bs({context:305,type:He.Null,optional:true})],Co.prototype,"earlyBootOnly",void 0);y([Bs({context:400,type:He.Integer,optional:true})],Co.prototype,"activeDateTime",void 0);y([Bs({context:401,type:He.Integer,optional:true})],Co.prototype,"originationExpireDateTime",void 0);y([Bs({context:402,type:He.Integer,optional:true})],Co.prototype,"usageExpireDateTime",void 0);y([Bs({context:405,type:He.Integer,optional:true})],Co.prototype,"usageCountLimit",void 0);y([Bs({context:503,type:He.Null,optional:true})],Co.prototype,"noAuthRequired",void 0);y([Bs({context:504,type:He.Integer,optional:true})],Co.prototype,"userAuthType",void 0);y([Bs({context:505,type:He.Integer,optional:true})],Co.prototype,"authTimeout",void 0);y([Bs({context:506,type:He.Null,optional:true})],Co.prototype,"allowWhileOnBody",void 0);y([Bs({context:507,type:He.Null,optional:true})],Co.prototype,"trustedUserPresenceRequired",void 0);y([Bs({context:508,type:He.Null,optional:true})],Co.prototype,"trustedConfirmationRequired",void 0);y([Bs({context:509,type:He.Null,optional:true})],Co.prototype,"unlockedDeviceRequired",void 0);y([Bs({context:600,type:He.Null,optional:true})],Co.prototype,"allApplications",void 0);y([Bs({context:601,type:Je,optional:true})],Co.prototype,"applicationId",void 0);y([Bs({context:701,type:He.Integer,optional:true})],Co.prototype,"creationDateTime",void 0);y([Bs({context:702,type:He.Integer,optional:true})],Co.prototype,"origin",void 0);y([Bs({context:703,type:He.Null,optional:true})],Co.prototype,"rollbackResistant",void 0);y([Bs({context:704,type:To,optional:true})],Co.prototype,"rootOfTrust",void 0);y([Bs({context:705,type:He.Integer,optional:true})],Co.prototype,"osVersion",void 0);y([Bs({context:706,type:He.Integer,optional:true})],Co.prototype,"osPatchLevel",void 0);y([Bs({context:709,type:Je,optional:true})],Co.prototype,"attestationApplicationId",void 0);y([Bs({context:710,type:Je,optional:true})],Co.prototype,"attestationIdBrand",void 0);y([Bs({context:711,type:Je,optional:true})],Co.prototype,"attestationIdDevice",void 0);y([Bs({context:712,type:Je,optional:true})],Co.prototype,"attestationIdProduct",void 0);y([Bs({context:713,type:Je,optional:true})],Co.prototype,"attestationIdSerial",void 0);y([Bs({context:714,type:Je,optional:true})],Co.prototype,"attestationIdImei",void 0);y([Bs({context:715,type:Je,optional:true})],Co.prototype,"attestationIdMeid",void 0);y([Bs({context:716,type:Je,optional:true})],Co.prototype,"attestationIdManufacturer",void 0);y([Bs({context:717,type:Je,optional:true})],Co.prototype,"attestationIdModel",void 0);y([Bs({context:718,type:He.Integer,optional:true})],Co.prototype,"vendorPatchLevel",void 0);y([Bs({context:719,type:He.Integer,optional:true})],Co.prototype,"bootPatchLevel",void 0);y([Bs({context:720,type:He.Null,optional:true})],Co.prototype,"deviceUniqueAttestation",void 0);var Do;(function(t){t[t["software"]=0]="software";t[t["trustedEnvironment"]=1]="trustedEnvironment";t[t["strongBox"]=2]="strongBox"})(Do||(Do={}));var Vo;(function(t){t[t["KM2"]=1]="KM2";t[t["KM3"]=2]="KM3";t[t["KM4"]=3]="KM4";t[t["KM4_1"]=4]="KM4_1";t[t["keyMint1"]=100]="keyMint1";t[t["keyMint2"]=200]="keyMint2"})(Vo||(Vo={}));class Po{constructor(t={}){this.attestationVersion=Vo.KM4;this.attestationSecurityLevel=Do.software;this.keymasterVersion=0;this.keymasterSecurityLevel=Do.software;this.attestationChallenge=new Je;this.uniqueId=new Je;this.softwareEnforced=new Co;this.teeEnforced=new Co;Object.assign(this,t)}}y([Bs({type:He.Integer})],Po.prototype,"attestationVersion",void 0);y([Bs({type:He.Enumerated})],Po.prototype,"attestationSecurityLevel",void 0);y([Bs({type:He.Integer})],Po.prototype,"keymasterVersion",void 0);y([Bs({type:He.Enumerated})],Po.prototype,"keymasterSecurityLevel",void 0);y([Bs({type:Je})],Po.prototype,"attestationChallenge",void 0);y([Bs({type:Je})],Po.prototype,"uniqueId",void 0);y([Bs({type:Co})],Po.prototype,"softwareEnforced",void 0);y([Bs({type:Co})],Po.prototype,"teeEnforced",void 0);var Mo;let qo=class t extends Co{};qo=y([As({type:We.Choice})],qo);let Lo=Mo=class t extends Es{constructor(t){super(t);Object.setPrototypeOf(this,Mo.prototype)}findProperty(t){const e=this.find((e=>t in e));if(e){return e[t]}return undefined}};Lo=Mo=y([As({type:We.Sequence,itemType:qo})],Lo);class Wo{constructor(t={}){this.attestationVersion=Vo.KM4;this.attestationSecurityLevel=Do.software;this.keymasterVersion=0;this.keymasterSecurityLevel=Do.software;this.attestationChallenge=new Je;this.uniqueId=new Je;this.softwareEnforced=new Lo;this.teeEnforced=new Lo;Object.assign(this,t)}}y([Bs({type:He.Integer})],Wo.prototype,"attestationVersion",void 0);y([Bs({type:He.Enumerated})],Wo.prototype,"attestationSecurityLevel",void 0);y([Bs({type:He.Integer})],Wo.prototype,"keymasterVersion",void 0);y([Bs({type:He.Enumerated})],Wo.prototype,"keymasterSecurityLevel",void 0);y([Bs({type:Je})],Wo.prototype,"attestationChallenge",void 0);y([Bs({type:Je})],Wo.prototype,"uniqueId",void 0);y([Bs({type:Lo})],Wo.prototype,"softwareEnforced",void 0);y([Bs({type:Lo})],Wo.prototype,"teeEnforced",void 0);class Ho{constructor(t={}){Object.assign(this,t)}}y([Bs({type:He.OctetString})],Ho.prototype,"packageName",void 0);y([Bs({type:He.Integer})],Ho.prototype,"version",void 0);class Fo{constructor(t={}){Object.assign(this,t)}}y([Bs({type:Ho,repeated:"set"})],Fo.prototype,"packageInfos",void 0);y([Bs({type:He.OctetString,repeated:"set"})],Fo.prototype,"signatureDigests",void 0);export{Is as $,_s as A,er as B,yr as C,p as D,Dr as E,ut as F,We as G,Me as H,Ur as I,ms as J,zr as K,qn as L,ws as M,Qr as N,Wt as O,Yr as P,Ki as Q,Ft as R,oi as S,eo as T,He as U,Le as V,Q as W,bs as X,pt as Y,st as Z,h as _,Ys as a,ts as a$,Os as a0,Si as a1,y as a2,Bs as a3,As as a4,Je as a5,Ke as a6,Ye as a7,Es as a8,ci as a9,hi as aA,Fi as aB,tn as aC,sn as aD,Tn as aE,Un as aF,on as aG,Kn as aH,Vn as aI,Ln as aJ,to as aK,Xn as aL,di as aM,yi as aN,Di as aO,Oo as aP,bi as aQ,vr as aR,gr as aS,mr as aT,$o as aU,Hs as aV,rr as aW,ki as aX,Fe as aY,Bi as aZ,$i as a_,Ai as aa,Ms as ab,Ii as ac,f as ad,Zs as ae,Qs as af,tr as ag,nr as ah,or as ai,ar as aj,xr as ak,Nr as al,$r as am,Cr as an,Vr as ao,Pr as ap,Mr as aq,qr as ar,Wr as as,Hr as at,Fr as au,Zr as av,Xr as aw,ei as ax,ni as ay,ui as az,Or as b,Rs as b0,Ri as b1,Ls as b2,ur as b3,hr as b4,Ws as b5,zi as b6,Zi as b7,Fo as b8,To as b9,Ro as ba,Tr as c,t as d,ri as e,li as f,fi as g,pi as h,gi as i,xi as j,wr as k,qi as l,en as m,nn as n,cn as o,Rn as p,jn as q,Wn as r,_n as s,Yn as t,vo as u,No as v,Wo as w,nt as x,gs as y,Ss as z};
//# sourceMappingURL=p-5b9ad1b8.js.map