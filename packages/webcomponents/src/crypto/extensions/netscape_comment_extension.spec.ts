/**
 * @license
 * Copyright (c) Peculiar Ventures, LLC.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */

import { Convert } from 'pvtsutils';
import { NetscapeCommentExtension } from './netscape_comment_extension';

describe('NetscapeCommentExtension', () => {
  it('should return correct JSON structure', () => {
    /**
     * Name: Netscape Comment
     * Critical: No
     * Comment: [comment text]
     */
    const hexExtension = '308203a106096086480186f842010d048203921682038e46494759454c454d2120457a656e2074616e7573697476616e792061204e65746c6f636b204b66742e204d696e6f73697465747420537a6f6c67616c74617461736920537a6162616c797a61746162616e206c6569727420656c6a617261736f6b20616c61706a616e206b65737a756c742e2041206b69626f637361746f74742074616e7573697476616e79686f7a20746172746f7a6f206d6167616e6b756c63732061206a6f67737a6162616c79692072656e64656c6b657a6573656b6e656b206d656766656c656c6f2042697a746f6e7361676f7320416c6169726173204c65747265686f7a6f2045737a6b6f7a62656e202842414c4529206b65737a756c742e2041206d696e6f73697465747420656c656b74726f6e696b757320616c6169726173206a6f67686174617320657276656e796573756c6573656e656b2c2076616c616d696e7420656c666f6761646173616e616b2066656c746574656c652061204d696e6f73697465747420537a6f6c67616c74617461736920537a6162616c797a617462616e2c20617a20416c74616c616e6f7320537a65727a6f646573692046656c746574656c656b62656e20656c6f69727420656c6c656e6f727a65736920656c6a61726173206d6567746574656c652e204120646f6b756d656e74756d6f6b206d656774616c616c6861746f6b20612068747470733a2f2f7777772e6e65746c6f636b2e68752f646f63732f2063696d656e2076616779206b65726865746f6b20617a20696e666f406e65746c6f636b2e6e657420652d6d61696c2063696d656e2e205741524e494e4721205468697320636572746966696361746520686173206265656e206973737565642061732061207175616c69666965642063657274696669636174652e2054686520636f72726573706f6e64696e672070726976617465206b657920686173206265656e2067656e657261746564206f6e206120536563757265205369676e6174757265204372656174696f6e20446576696365202853534344292e205468652069737375616e636520616e642074686520757365206f66207468697320636572746966696361746520617265207375626a65637420746f20746865204e65746c6f636b205175616c69666965642043505320617661696c61626c652061742068747470733a2f2f7777772e6e65746c6f636b2e6875646f63732f206f7220627920652d6d61696c20617420696e666f406e65746c6f636b2e6e6574';
    const extension = new NetscapeCommentExtension(Convert.FromHex(hexExtension));

    const json = extension.toJSON();

    expect(json).toEqual({
      Name: 'Netscape Comment',
      Critical: 'No',
      Comment: 'FIGYELEM! Ezen tanusitvany a Netlock Kft. Minositett Szolgaltatasi Szabalyzataban leirt eljarasok alapjan keszult. A kibocsatott tanusitvanyhoz tartozo magankulcs a jogszabalyi rendelkezeseknek megfelelo Biztonsagos Alairas Letrehozo Eszkozben (BALE) keszult. A minositett elektronikus alairas joghatas ervenyesulesenek, valamint elfogadasanak feltetele a Minositett Szolgaltatasi Szabalyzatban, az Altalanos Szerzodesi Feltetelekben eloirt ellenorzesi eljaras megtetele. A dokumentumok megtalalhatok a https://www.netlock.hu/docs/ cimen vagy kerhetok az info@netlock.net e-mail cimen. WARNING! This certificate has been issued as a qualified certificate. The corresponding private key has been generated on a Secure Signature Creation Device (SSCD). The issuance and the use of this certificate are subject to the Netlock Qualified CPS available at https://www.netlock.hudocs/ or by e-mail at info@netlock.net',
    });
  });
});
